import{w as A,bI as se,a4 as S,j as e,B as D,bO as W,bP as O,bQ as ne,a7 as _,I as u,bJ as re,bK as oe,M as L,y as $,a6 as le,c as v,r as p,bR as de,a0 as y,aa as ie,p as T,J as ce,U as me,K as he,ah as pe,ab as ue,X as k,Y as G,Z as I,bx as xe}from"./index-BJkBHIXD.js";import{a as be,b as ge,D as J}from"./department-create-edit-form-DUV7k7Ni.js";import{a as M,d as N,u as je}from"./department-BOJZtc9U.js";import{C as K}from"./confirm-dialog-D488U7AY.js";import{u as fe,g as Ce,e as ve,T as De}from"./table-no-data-BKo9R2Zy.js";import{T as ye}from"./table-empty-rows-BDBaI17h.js";import{T as Te}from"./table-head-custom-C2dATJUG.js";import{T as Se}from"./table-selected-action-uAaUSqFj.js";import{T as Re}from"./table-pagination-custom-Dom7EZhX.js";import{T as Pe,a as C,b as Fe,c as we}from"./TableHead-D9jAElFw.js";import{C as ke}from"./FormControlLabel-Do9AncA_.js";import{S as z}from"./Stack-DSqJGNfN.js";import{C as H}from"./Chip-Cd7PxQUv.js";import{C as Ie}from"./Card-CU8jzKuK.js";function Ae({row:n,selected:i,editHref:s,onSelectRow:t,onDeleteRow:c,onEdit:l}){const{t:r}=A("navbar"),o=se(),h=S(),g=()=>e.jsx(re,{open:o.open,anchorEl:o.anchorEl,onClose:o.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(oe,{children:[e.jsx("li",{children:e.jsxs(L,{onClick:()=>{o.onClose(),l&&l(n.id)},component:l?"div":$,href:l?void 0:s,children:[e.jsx(u,{icon:"solar:pen-bold"}),r("dashboard.department.menu.edit")]})}),e.jsx(le,{sx:{borderStyle:"dashed"}}),e.jsxs(L,{onClick:()=>{h.onTrue(),o.onClose()},sx:{color:"error.main"},children:[e.jsx(u,{icon:"solar:trash-bin-trash-bold"}),r("dashboard.department.menu.delete")]})]})}),R=()=>e.jsx(K,{open:h.value,onClose:h.onFalse,title:r("dashboard.department.confirmDialog.delete"),content:r("dashboard.department.confirmDialog.deleteConfirm"),action:e.jsx(v,{variant:"contained",color:"error",onClick:c,children:r("dashboard.department.confirmDialog.delete")})});return e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{hover:!0,selected:i,children:[e.jsx(C,{padding:"checkbox",children:e.jsx(ke,{checked:i,onClick:t,slotProps:{input:{id:`${n.id}-checkbox`,"aria-label":`${n.id} checkbox`}}})}),e.jsx(C,{children:e.jsx(D,{sx:{display:"flex",alignItems:"center"},children:e.jsx(W,{primary:n.name,secondary:n.id,slotProps:{primary:{noWrap:!0,sx:{typography:"body2"}},secondary:{sx:{mt:.5,typography:"caption"}}}})})}),e.jsx(C,{children:e.jsx(O,{variant:"soft",color:n.status==="active"&&"success"||n.status==="inactive"&&"error"||"default",children:n.status==="active"?r("dashboard.department.status.active"):n.status==="inactive"?r("dashboard.department.status.inactive"):n.status})}),e.jsx(C,{children:e.jsx(W,{primary:ne(n.createdAt),slotProps:{primary:{noWrap:!0,sx:{typography:"body2"}}}})}),e.jsx(C,{align:"right",sx:{px:1},children:e.jsx(_,{color:o.open?"inherit":"default",onClick:o.onOpen,children:e.jsx(u,{icon:"eva:more-vertical-fill"})})})]}),g(),R()]})}function Ee({filters:n,onFilters:i,onResetFilters:s,results:t,sx:c}){const l=()=>{i("status",{...n,status:"all"})},r=()=>{i("name",{...n,name:""})};return e.jsxs(z,{spacing:1.5,sx:{...c},children:[e.jsxs(D,{sx:{typography:"body2"},children:[e.jsx("strong",{children:t}),e.jsx(D,{component:"span",sx:{color:"text.secondary",ml:.25},children:"results found"})]}),e.jsxs(z,{flexWrap:"wrap",direction:"row",spacing:1,children:[!!n.name&&e.jsx(H,{size:"small",label:"Name",onDelete:r,deleteIcon:e.jsx(u,{icon:"eva:minus-circle-fill"})}),n.status&&n.status!=="all"&&e.jsx(H,{size:"small",label:"Status",onDelete:l,deleteIcon:e.jsx(u,{icon:"eva:minus-circle-fill"})}),e.jsx(v,{color:"error",size:"small",onClick:s,startIcon:e.jsx(u,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})]})}function Xe({showBreadcrumbs:n=!0,showActionButton:i=!0}){const{t:s}=A("navbar"),t=fe(),c=[{id:"name",label:s("dashboard.department.tableHeaders.departmentName"),width:250},{id:"status",label:s("dashboard.department.tableHeaders.status"),width:100},{id:"createdAt",label:s("dashboard.department.tableHeaders.createdAt"),width:180},{id:"",width:88}],l=S(),r=S(),o=S(),[h,g]=p.useState(null),R=de({name:"",status:"all"}),{state:m,setState:j}=R,{departments:P,pagination:E,refetch:b}=M({search:m.name,status:m.status,per_page:t.rowsPerPage,page:t.page+1,sort:t.orderBy||"created_at",order:t.order}),[U,Q]=p.useState([]),[F,V]=p.useState({all:0,active:0,inactive:0}),{departments:f}=M({per_page:1e3});p.useEffect(()=>{if(f){const a=f.filter(w=>w.status==="active").length,d=f.filter(w=>w.status==="inactive").length;V({all:f.length,active:a,inactive:d})}},[f]),p.useEffect(()=>{P&&Q(P)},[P]);const x=We({inputData:U,comparator:Ce(t.order,t.orderBy),filters:m}),B=!!m.name||m.status!=="all"&&!!m.status,X=!x.length&&B||!x.length,Y=p.useCallback(async a=>{try{await N(a),y.success(s("dashboard.department.toast.deletedSuccessfully")),b()}catch(d){console.error("Failed to delete department:",d),y.error(s("dashboard.department.toast.deleteFailed"))}},[b,s]),Z=p.useCallback(async()=>{try{await Promise.all(t.selected.map(a=>N(a))),y.success(s("dashboard.department.toast.deletedMultipleSuccessfully")),t.onSelectAllRows(!1,[]),b()}catch(a){console.error("Failed to delete departments:",a),y.error(s("dashboard.department.toast.deleteMultipleFailed"))}},[t,b,s]),q=p.useCallback((a,d)=>{t.onResetPage(),j({status:d})},[j,t]),ee=p.useCallback(a=>{g(a),o.onTrue()},[o]),te=()=>e.jsx(K,{open:l.value,onClose:l.onFalse,title:s("dashboard.department.confirmDialog.delete"),content:e.jsx(e.Fragment,{children:s("dashboard.department.confirmDialog.deleteMultipleConfirm",{count:t.selected.length})}),action:e.jsx(v,{variant:"contained",color:"error",onClick:()=>{Z(),l.onFalse()},children:s("dashboard.department.confirmDialog.delete")})}),ae=[{value:"all",label:s("dashboard.department.tabs.all"),color:"default",count:F.all},{value:"active",label:s("dashboard.department.tabs.active"),color:"success",count:F.active},{value:"inactive",label:s("dashboard.department.tabs.inactive"),color:"error",count:F.inactive}];return e.jsxs(e.Fragment,{children:[n?e.jsx(ie,{heading:s("dashboard.department.list"),links:[{name:"Dashboard",href:T.dashboard.root},{name:s("dashboard.department.heading"),href:T.dashboard.department.root},{name:s("dashboard.department.list")}],action:i?e.jsx(v,{component:$,href:T.dashboard.department.new,variant:"contained",startIcon:e.jsx(u,{icon:"mingcute:add-line"}),children:s("dashboard.department.addDepartment")}):void 0,sx:{mb:{xs:3,md:5}}}):i&&e.jsx(D,{sx:{display:"flex",justifyContent:"flex-end",mb:{xs:3,md:5}},children:e.jsx(v,{onClick:r.onTrue,variant:"contained",startIcon:e.jsx(u,{icon:"mingcute:add-line"}),children:s("dashboard.department.addDepartment")})}),e.jsxs(Ie,{children:[e.jsx(ce,{value:m.status,onChange:q,sx:[a=>({px:{md:2.5},boxShadow:`inset 0 -2px 0 0 ${me(a.vars.palette.grey["500Channel"],.08)}`})],children:ae.map(a=>e.jsx(he,{value:a.value,label:a.label,iconPosition:"end",icon:e.jsx(O,{variant:(a.value==="all"||a.value===m.status)&&"filled"||"soft",color:a.color,children:a.count})},a.value))}),e.jsx(be,{filters:m,onFilters:(a,d)=>j({[a]:d}),statusOptions:ge.map(a=>a.label)}),B&&e.jsx(Ee,{filters:m,onFilters:(a,d)=>j({[a]:d}),onResetFilters:()=>j({name:"",status:"all"}),results:x.length,sx:{p:2.5,pt:0}}),e.jsxs(D,{sx:{position:"relative"},children:[t.selected.length>0&&e.jsx(Se,{dense:t.dense,numSelected:t.selected.length,rowCount:x.length,onSelectAllRows:a=>t.onSelectAllRows(a,x.map(d=>d.id)),action:e.jsx(pe,{title:s("dashboard.department.tooltip.delete"),children:e.jsx(_,{color:"primary",onClick:l.onTrue,children:e.jsx(u,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(ue,{children:e.jsxs(Fe,{size:t.dense?"small":"medium",sx:{minWidth:800},children:[e.jsx(Te,{order:t.order,orderBy:t.orderBy,headCells:c,rowCount:x.length,numSelected:t.selected.length,onSort:t.onSort,onSelectAllRows:a=>t.onSelectAllRows(a,x.map(d=>d.id))}),e.jsxs(we,{children:[x.map(a=>e.jsx(Ae,{row:a,selected:t.selected.includes(a.id),onSelectRow:()=>t.onSelectRow(a.id),onDeleteRow:()=>Y(a.id),editHref:T.dashboard.department.edit(a.id),onEdit:ee},a.id)),e.jsx(ye,{height:t.dense?56:76,emptyRows:ve(t.page,t.rowsPerPage,E.total)}),e.jsx(De,{notFound:X})]})]})})]}),e.jsx(Re,{page:t.page,dense:t.dense,count:E.total,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,onChangeDense:t.onChangeDense,onRowsPerPageChange:t.onChangeRowsPerPage})]}),te(),e.jsxs(k,{fullWidth:!0,maxWidth:"sm",open:r.value,onClose:r.onFalse,children:[e.jsx(G,{children:s("dashboard.department.createNewDepartment")}),e.jsx(I,{children:e.jsx(J,{onClose:r.onFalse,onSuccess:()=>{r.onFalse(),b()}})})]}),h&&e.jsx(Be,{open:o.value,departmentId:h,onClose:()=>{o.onFalse(),g(null)},onSuccess:()=>{o.onFalse(),g(null),b()}})]})}function Be({open:n,departmentId:i,onClose:s,onSuccess:t}){const{t:c}=A("navbar"),{department:l,loading:r}=je(i);return r?e.jsx(k,{fullWidth:!0,maxWidth:"sm",open:n,onClose:s,children:e.jsx(I,{children:e.jsx(xe,{})})}):e.jsxs(k,{fullWidth:!0,maxWidth:"sm",open:n,onClose:s,children:[e.jsx(G,{children:c("dashboard.department.editDepartment")}),e.jsx(I,{children:l&&e.jsx(J,{currentDepartment:l,onClose:s,onSuccess:t})})]})}function We({inputData:n,comparator:i,filters:s}){const{name:t,status:c}=s,l=n.map((r,o)=>[r,o]);return l.sort((r,o)=>{const h=i(r[0],o[0]);return h!==0?h:r[1]-o[1]}),n=l.map(r=>r[0]),t&&typeof t=="string"&&(n=n.filter(r=>r.name?.toLowerCase().indexOf(t.toLowerCase())!==-1)),c!=="all"&&(n=n.filter(r=>r.status===c)),n}export{Xe as D};
