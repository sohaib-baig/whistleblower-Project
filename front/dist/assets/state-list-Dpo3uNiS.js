import{w as A,bI as se,a4 as D,j as e,B as S,bO as W,bP as O,bQ as oe,a7 as _,I as x,bJ as le,bK as ne,M as L,y as $,a6 as re,c as v,r as m,bR as ie,a0 as y,aa as de,p as T,J as ce,U as he,K as ue,ah as me,ab as xe,X as k,Y as G,Z as I,bx as be}from"./index-BJkBHIXD.js";import{a as pe,b as ge,S as J}from"./state-create-edit-form-Ce1HeCDb.js";import{a as M,d as z,u as je}from"./state-DFemdeiH.js";import{C as K}from"./confirm-dialog-D488U7AY.js";import{u as fe,g as Ce,e as ve,T as Se}from"./table-no-data-BKo9R2Zy.js";import{T as ye}from"./table-empty-rows-BDBaI17h.js";import{T as Te}from"./table-head-custom-C2dATJUG.js";import{T as De}from"./table-selected-action-uAaUSqFj.js";import{T as Re}from"./table-pagination-custom-Dom7EZhX.js";import{T as Fe,a as C,b as Pe,c as we}from"./TableHead-D9jAElFw.js";import{C as ke}from"./FormControlLabel-Do9AncA_.js";import{S as H}from"./Stack-DSqJGNfN.js";import{C as N}from"./Chip-Cd7PxQUv.js";import{C as Ie}from"./Card-CU8jzKuK.js";function Ae({row:o,selected:d,editHref:s,onSelectRow:t,onDeleteRow:c,onEdit:r}){const{t:l}=A("navbar"),n=se(),u=D(),g=()=>e.jsx(le,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(ne,{children:[e.jsx("li",{children:e.jsxs(L,{onClick:()=>{n.onClose(),r&&r(o.id)},component:r?"div":$,href:r?void 0:s,children:[e.jsx(x,{icon:"solar:pen-bold"}),l("dashboard.state.menu.edit")]})}),e.jsx(re,{sx:{borderStyle:"dashed"}}),e.jsxs(L,{onClick:()=>{u.onTrue(),n.onClose()},sx:{color:"error.main"},children:[e.jsx(x,{icon:"solar:trash-bin-trash-bold"}),l("dashboard.state.menu.delete")]})]})}),R=()=>e.jsx(K,{open:u.value,onClose:u.onFalse,title:l("dashboard.state.confirmDialog.delete"),content:l("dashboard.state.confirmDialog.deleteConfirm"),action:e.jsx(v,{variant:"contained",color:"error",onClick:c,children:l("dashboard.state.confirmDialog.delete")})});return e.jsxs(e.Fragment,{children:[e.jsxs(Fe,{hover:!0,selected:d,children:[e.jsx(C,{padding:"checkbox",children:e.jsx(ke,{checked:d,onClick:t,slotProps:{input:{id:`${o.id}-checkbox`,"aria-label":`${o.id} checkbox`}}})}),e.jsx(C,{children:e.jsx(S,{sx:{display:"flex",alignItems:"center"},children:e.jsx(W,{primary:o.name,secondary:o.id,slotProps:{primary:{noWrap:!0,sx:{typography:"body2"}},secondary:{sx:{mt:.5,typography:"caption"}}}})})}),e.jsx(C,{children:e.jsx(O,{variant:"soft",color:o.status==="active"&&"success"||o.status==="inactive"&&"error"||"default",children:o.status==="active"?l("dashboard.state.status.active"):o.status==="inactive"?l("dashboard.state.status.inactive"):o.status})}),e.jsx(C,{children:e.jsx(W,{primary:oe(o.createdAt),slotProps:{primary:{noWrap:!0,sx:{typography:"body2"}}}})}),e.jsx(C,{align:"right",sx:{px:1},children:e.jsx(_,{color:n.open?"inherit":"default",onClick:n.onOpen,children:e.jsx(x,{icon:"eva:more-vertical-fill"})})})]}),g(),R()]})}function Ee({filters:o,onFilters:d,onResetFilters:s,results:t,sx:c}){const r=()=>{d("status",{...o,status:"all"})},l=()=>{d("name",{...o,name:""})};return e.jsxs(H,{spacing:1.5,sx:{...c},children:[e.jsxs(S,{sx:{typography:"body2"},children:[e.jsx("strong",{children:t}),e.jsx(S,{component:"span",sx:{color:"text.secondary",ml:.25},children:"results found"})]}),e.jsxs(H,{flexWrap:"wrap",direction:"row",spacing:1,children:[!!o.name&&e.jsx(N,{size:"small",label:"Name",onDelete:l,deleteIcon:e.jsx(x,{icon:"eva:minus-circle-fill"})}),o.status&&o.status!=="all"&&e.jsx(N,{size:"small",label:"Status",onDelete:r,deleteIcon:e.jsx(x,{icon:"eva:minus-circle-fill"})}),e.jsx(v,{color:"error",size:"small",onClick:s,startIcon:e.jsx(x,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})]})}function Xe({showBreadcrumbs:o=!0,showActionButton:d=!0}){const{t:s}=A("navbar"),t=fe(),c=[{id:"name",label:s("dashboard.state.tableHeaders.stateName"),width:250},{id:"status",label:s("dashboard.state.tableHeaders.status"),width:100},{id:"createdAt",label:s("dashboard.state.tableHeaders.createdAt"),width:180},{id:"",width:88}],r=D(),l=D(),n=D(),[u,g]=m.useState(null),R=ie({name:"",status:"all"}),{state:h,setState:j}=R,{states:F,pagination:E,refetch:p}=M({search:h.name,status:h.status,per_page:t.rowsPerPage,page:t.page+1,sort:t.orderBy||"created_at",order:t.order}),[U,Q]=m.useState([]),[P,V]=m.useState({all:0,active:0,inactive:0}),{states:f}=M({per_page:1e3});m.useEffect(()=>{if(f){const a=f.filter(w=>w.status==="active").length,i=f.filter(w=>w.status==="inactive").length;V({all:f.length,active:a,inactive:i})}},[f]),m.useEffect(()=>{F&&Q(F)},[F]);const b=We({inputData:U,comparator:Ce(t.order,t.orderBy),filters:h}),B=!!h.name||h.status!=="all"&&!!h.status,X=!b.length&&B||!b.length,Y=m.useCallback(async a=>{try{await z(a),y.success(s("dashboard.state.toast.deletedSuccessfully")),p()}catch(i){console.error("Failed to delete state:",i),y.error(s("dashboard.state.toast.deleteFailed"))}},[p,s]),Z=m.useCallback(async()=>{try{await Promise.all(t.selected.map(a=>z(a))),y.success(s("dashboard.state.toast.deletedMultipleSuccessfully")),t.onSelectAllRows(!1,[]),p()}catch(a){console.error("Failed to delete states:",a),y.error(s("dashboard.state.toast.deleteMultipleFailed"))}},[t,p,s]),q=m.useCallback((a,i)=>{t.onResetPage(),j({status:i})},[j,t]),ee=m.useCallback(a=>{g(a),n.onTrue()},[n]),te=()=>e.jsx(K,{open:r.value,onClose:r.onFalse,title:s("dashboard.state.confirmDialog.delete"),content:e.jsx(e.Fragment,{children:s("dashboard.state.confirmDialog.deleteMultipleConfirm",{count:t.selected.length})}),action:e.jsx(v,{variant:"contained",color:"error",onClick:()=>{Z(),r.onFalse()},children:s("dashboard.state.confirmDialog.delete")})}),ae=[{value:"all",label:s("dashboard.state.tabs.all"),color:"default",count:P.all},{value:"active",label:s("dashboard.state.tabs.active"),color:"success",count:P.active},{value:"inactive",label:s("dashboard.state.tabs.inactive"),color:"error",count:P.inactive}];return e.jsxs(e.Fragment,{children:[o?e.jsx(de,{heading:s("dashboard.state.list"),links:[{name:"Dashboard",href:T.dashboard.root},{name:s("dashboard.state.heading"),href:T.dashboard.state.root},{name:s("dashboard.state.list")}],action:d?e.jsx(v,{component:$,href:T.dashboard.state.new,variant:"contained",startIcon:e.jsx(x,{icon:"mingcute:add-line"}),children:s("dashboard.state.addState")}):void 0,sx:{mb:{xs:3,md:5}}}):d&&e.jsx(S,{sx:{display:"flex",justifyContent:"flex-end",mb:{xs:3,md:5}},children:e.jsx(v,{onClick:l.onTrue,variant:"contained",startIcon:e.jsx(x,{icon:"mingcute:add-line"}),children:s("dashboard.state.addState")})}),e.jsxs(Ie,{children:[e.jsx(ce,{value:h.status,onChange:q,sx:[a=>({px:{md:2.5},boxShadow:`inset 0 -2px 0 0 ${he(a.vars.palette.grey["500Channel"],.08)}`})],children:ae.map(a=>e.jsx(ue,{value:a.value,label:a.label,iconPosition:"end",icon:e.jsx(O,{variant:(a.value==="all"||a.value===h.status)&&"filled"||"soft",color:a.color,children:a.count})},a.value))}),e.jsx(pe,{filters:h,onFilters:(a,i)=>j({[a]:i}),statusOptions:ge.map(a=>a.label)}),B&&e.jsx(Ee,{filters:h,onFilters:(a,i)=>j({[a]:i}),onResetFilters:()=>j({name:"",status:"all"}),results:b.length,sx:{p:2.5,pt:0}}),e.jsxs(S,{sx:{position:"relative"},children:[t.selected.length>0&&e.jsx(De,{dense:t.dense,numSelected:t.selected.length,rowCount:b.length,onSelectAllRows:a=>t.onSelectAllRows(a,b.map(i=>i.id)),action:e.jsx(me,{title:s("dashboard.state.tooltip.delete"),children:e.jsx(_,{color:"primary",onClick:r.onTrue,children:e.jsx(x,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(xe,{children:e.jsxs(Pe,{size:t.dense?"small":"medium",sx:{minWidth:800},children:[e.jsx(Te,{order:t.order,orderBy:t.orderBy,headCells:c,rowCount:b.length,numSelected:t.selected.length,onSort:t.onSort,onSelectAllRows:a=>t.onSelectAllRows(a,b.map(i=>i.id))}),e.jsxs(we,{children:[b.map(a=>e.jsx(Ae,{row:a,selected:t.selected.includes(a.id),onSelectRow:()=>t.onSelectRow(a.id),onDeleteRow:()=>Y(a.id),editHref:T.dashboard.state.edit(a.id),onEdit:ee},a.id)),e.jsx(ye,{height:t.dense?56:76,emptyRows:ve(t.page,t.rowsPerPage,E.total)}),e.jsx(Se,{notFound:X})]})]})})]}),e.jsx(Re,{page:t.page,dense:t.dense,count:E.total,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,onChangeDense:t.onChangeDense,onRowsPerPageChange:t.onChangeRowsPerPage})]}),te(),e.jsxs(k,{fullWidth:!0,maxWidth:"sm",open:l.value,onClose:l.onFalse,children:[e.jsx(G,{children:s("dashboard.state.createNewState")}),e.jsx(I,{children:e.jsx(J,{onClose:l.onFalse,onSuccess:()=>{l.onFalse(),p()}})})]}),u&&e.jsx(Be,{open:n.value,stateId:u,onClose:()=>{n.onFalse(),g(null)},onSuccess:()=>{n.onFalse(),g(null),p()}})]})}function Be({open:o,stateId:d,onClose:s,onSuccess:t}){const{t:c}=A("navbar"),{state:r,loading:l}=je(d);return l?e.jsx(k,{fullWidth:!0,maxWidth:"sm",open:o,onClose:s,children:e.jsx(I,{children:e.jsx(be,{})})}):e.jsxs(k,{fullWidth:!0,maxWidth:"sm",open:o,onClose:s,children:[e.jsx(G,{children:c("dashboard.state.editState")}),e.jsx(I,{children:r&&e.jsx(J,{currentState:r,onClose:s,onSuccess:t})})]})}function We({inputData:o,comparator:d,filters:s}){const{name:t,status:c}=s,r=o.map((l,n)=>[l,n]);return r.sort((l,n)=>{const u=d(l[0],n[0]);return u!==0?u:l[1]-n[1]}),o=r.map(l=>l[0]),t&&typeof t=="string"&&(o=o.filter(l=>l.name?.toLowerCase().indexOf(t.toLowerCase())!==-1)),c!=="all"&&(o=o.filter(l=>l.status===c)),o}export{Xe as S};
