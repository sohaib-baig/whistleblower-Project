import{r as i,aS as H,bj as W,g as G,j as t,k as F,l as z,o as Z,b9 as me,c7 as Ce,t as q,b1 as te,n as ue,bf as Le,G as oe,e as B,B as R,I as ie,w as K,L as ce,X as ge,Y as he,T as S,a7 as Ue,Z as xe,b as be,_ as ye,c as A,ah as we,u as Ne,a6 as Pe,i as J,s as X,x as ve,C as Ee}from"./index-BJkBHIXD.js";import{u as fe,a as Ie}from"./index.esm-DG78EUPk.js";import{a as Re}from"./zod-DbnPk1Kl.js";import"./text-transform-DM798QSo.js";import"./styles-B-zEs6qR.js";import{s as ke}from"./schema-utils-C_-d4BNQ.js";import{F as Fe}from"./form-provider-BYLnCB41.js";import{F as $,R as Oe}from"./fields-wQ2IQIfM.js";import{R as Me}from"./rhf-phone-input-DvY4aKGv.js";import{P as $e}from"./privacy-policy-content-D_zIEEaB.js";import{S as Q}from"./Stack-DSqJGNfN.js";import{G as ne}from"./Grid-D_Et280v.js";import{C as re}from"./Card-CU8jzKuK.js";import{o as Y,c as Ae,s as M,b as De}from"./schemas-BaSQ7w8v.js";import"./TextField-BfOXJaKd.js";import"./Select-CM-FquqI.js";import"./format-number-BErDzwe7.js";import"./index-BdCJuPE0.js";import"./rhf-text-field-D45rQogC.js";import"./RadioGroup-eX8WPtuC.js";import"./FormControlLabel-Do9AncA_.js";import"./Autocomplete-vOabT0lM.js";import"./Chip-Cd7PxQUv.js";import"./InputAdornment-Cyf39fZQ.js";import"./rhf-select-BCHEEYe2.js";import"./upload-default-BMHhCMpu.js";import"./index-CDpvdXdB.js";import"./tslib.es6-CTYbIaVE.js";import"./DatePicker-D3hVcc_W.js";import"./search-not-found-BYtFGFNz.js";const ee=i.createContext({}),le=i.createContext({});function ze(e){return H("MuiStep",e)}W("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const Be=e=>{const{classes:n,orientation:a,alternativeLabel:r,completed:s}=e;return Z({root:["root",a,r&&"alternativeLabel",s&&"completed"]},ze,n)},_e=F("div",{name:"MuiStep",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:a}=e;return[n.root,n[a.orientation],a.alternativeLabel&&n.alternativeLabel,a.completed&&n.completed]}})({variants:[{props:{orientation:"horizontal"},style:{paddingLeft:8,paddingRight:8}},{props:{alternativeLabel:!0},style:{flex:1,position:"relative"}}]}),Ve=i.forwardRef(function(n,a){const r=G({props:n,name:"MuiStep"}),{active:s,children:p,className:g,component:d="div",completed:o,disabled:h,expanded:b=!1,index:c,last:m,...N}=r,{activeStep:U,connector:C,alternativeLabel:P,orientation:E,nonLinear:T}=i.useContext(ee);let[L=!1,w=!1,y=!1]=[s,o,h];U===c?L=s!==void 0?s:!0:!T&&U>c?w=o!==void 0?o:!0:!T&&U<c&&(y=h!==void 0?h:!0);const j=i.useMemo(()=>({index:c,last:m,expanded:b,icon:c+1,active:L,completed:w,disabled:y}),[c,m,b,L,w,y]),f={...r,active:L,orientation:E,alternativeLabel:P,completed:w,disabled:y,expanded:b,component:d},I=Be(f),l=t.jsxs(_e,{as:d,className:z(I.root,g),ref:a,ownerState:f,...N,children:[C&&P&&c!==0?C:null,p]});return t.jsx(le.Provider,{value:j,children:C&&!P&&c!==0?t.jsxs(i.Fragment,{children:[C,l]}):l})}),He=me(t.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"})),We=me(t.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}));function Ge(e){return H("MuiStepIcon",e)}const se=W("MuiStepIcon",["root","active","completed","error","text"]);var pe;const Ze=e=>{const{classes:n,active:a,completed:r,error:s}=e;return Z({root:["root",a&&"active",r&&"completed",s&&"error"],text:["text"]},Ge,n)},ae=F(Ce,{name:"MuiStepIcon",slot:"Root"})(q(({theme:e})=>({display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),color:(e.vars||e).palette.text.disabled,[`&.${se.completed}`]:{color:(e.vars||e).palette.primary.main},[`&.${se.active}`]:{color:(e.vars||e).palette.primary.main},[`&.${se.error}`]:{color:(e.vars||e).palette.error.main}}))),qe=F("text",{name:"MuiStepIcon",slot:"Text"})(q(({theme:e})=>({fill:(e.vars||e).palette.primary.contrastText,fontSize:e.typography.caption.fontSize,fontFamily:e.typography.fontFamily}))),Ke=i.forwardRef(function(n,a){const r=G({props:n,name:"MuiStepIcon"}),{active:s=!1,className:p,completed:g=!1,error:d=!1,icon:o,...h}=r,b={...r,active:s,completed:g,error:d},c=Ze(b);if(typeof o=="number"||typeof o=="string"){const m=z(p,c.root);return d?t.jsx(ae,{as:We,className:m,ref:a,ownerState:b,...h}):g?t.jsx(ae,{as:He,className:m,ref:a,ownerState:b,...h}):t.jsxs(ae,{className:m,ref:a,ownerState:b,...h,children:[pe||(pe=t.jsx("circle",{cx:"12",cy:"12",r:"12"})),t.jsx(qe,{className:c.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:b,children:o})]})}return o});function Ye(e){return H("MuiStepLabel",e)}const D=W("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),Je=e=>{const{classes:n,orientation:a,active:r,completed:s,error:p,disabled:g,alternativeLabel:d}=e;return Z({root:["root",a,p&&"error",g&&"disabled",d&&"alternativeLabel"],label:["label",r&&"active",s&&"completed",p&&"error",g&&"disabled",d&&"alternativeLabel"],iconContainer:["iconContainer",r&&"active",s&&"completed",p&&"error",g&&"disabled",d&&"alternativeLabel"],labelContainer:["labelContainer",d&&"alternativeLabel"]},Ye,n)},Xe=F("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:a}=e;return[n.root,n[a.orientation]]}})({display:"flex",alignItems:"center",[`&.${D.alternativeLabel}`]:{flexDirection:"column"},[`&.${D.disabled}`]:{cursor:"default"},variants:[{props:{orientation:"vertical"},style:{textAlign:"left",padding:"8px 0"}}]}),Qe=F("span",{name:"MuiStepLabel",slot:"Label"})(q(({theme:e})=>({...e.typography.body2,display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),[`&.${D.active}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${D.completed}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${D.alternativeLabel}`]:{marginTop:16},[`&.${D.error}`]:{color:(e.vars||e).palette.error.main}}))),et=F("span",{name:"MuiStepLabel",slot:"IconContainer"})({flexShrink:0,display:"flex",paddingRight:8,[`&.${D.alternativeLabel}`]:{paddingRight:0}}),tt=F("span",{name:"MuiStepLabel",slot:"LabelContainer"})(q(({theme:e})=>({width:"100%",color:(e.vars||e).palette.text.secondary,[`&.${D.alternativeLabel}`]:{textAlign:"center"}}))),Se=i.forwardRef(function(n,a){const r=G({props:n,name:"MuiStepLabel"}),{children:s,className:p,componentsProps:g={},error:d=!1,icon:o,optional:h,slots:b={},slotProps:c={},StepIconComponent:m,StepIconProps:N,...U}=r,{alternativeLabel:C,orientation:P}=i.useContext(ee),{active:E,disabled:T,completed:L,icon:w}=i.useContext(le),y=o||w;let j=m;y&&!j&&(j=Ke);const f={...r,active:E,alternativeLabel:C,completed:L,disabled:T,error:d,orientation:P},I=Je(f),l={slots:b,slotProps:{stepIcon:N,...g,...c}},[u,x]=te("root",{elementType:Xe,externalForwardedProps:{...l,...U},ownerState:f,ref:a,className:z(I.root,p)}),[v,k]=te("label",{elementType:Qe,externalForwardedProps:l,ownerState:f}),[O,_]=te("stepIcon",{elementType:j,externalForwardedProps:l,ownerState:f});return t.jsxs(u,{...x,children:[y||O?t.jsx(et,{className:I.iconContainer,ownerState:f,children:t.jsx(O,{completed:L,active:E,error:d,icon:y,..._})}):null,t.jsxs(tt,{className:I.labelContainer,ownerState:f,children:[s?t.jsx(v,{...k,className:z(I.label,k?.className),children:s}):null,h]})]})});Se.muiName="StepLabel";function nt(e){return H("MuiStepConnector",e)}W("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const st=e=>{const{classes:n,orientation:a,alternativeLabel:r,active:s,completed:p,disabled:g}=e,d={root:["root",a,r&&"alternativeLabel",s&&"active",p&&"completed",g&&"disabled"],line:["line",`line${ue(a)}`]};return Z(d,nt,n)},at=F("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:a}=e;return[n.root,n[a.orientation],a.alternativeLabel&&n.alternativeLabel,a.completed&&n.completed]}})({flex:"1 1 auto",variants:[{props:{orientation:"vertical"},style:{marginLeft:12}},{props:{alternativeLabel:!0},style:{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"}}]}),rt=F("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(e,n)=>{const{ownerState:a}=e;return[n.line,n[`line${ue(a.orientation)}`]]}})(q(({theme:e})=>{const n=e.palette.mode==="light"?e.palette.grey[400]:e.palette.grey[600];return{display:"block",borderColor:e.vars?e.vars.palette.StepConnector.border:n,variants:[{props:{orientation:"horizontal"},style:{borderTopStyle:"solid",borderTopWidth:1}},{props:{orientation:"vertical"},style:{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24}}]}})),ot=i.forwardRef(function(n,a){const r=G({props:n,name:"MuiStepConnector"}),{className:s,...p}=r,{alternativeLabel:g,orientation:d="horizontal"}=i.useContext(ee),{active:o,disabled:h,completed:b}=i.useContext(le),c={...r,alternativeLabel:g,orientation:d,active:o,completed:b,disabled:h},m=st(c);return t.jsx(at,{className:z(m.root,s),ref:a,ownerState:c,...p,children:t.jsx(rt,{className:m.line,ownerState:c})})});function it(e){return H("MuiStepper",e)}W("MuiStepper",["root","horizontal","vertical","nonLinear","alternativeLabel"]);const lt=e=>{const{orientation:n,nonLinear:a,alternativeLabel:r,classes:s}=e;return Z({root:["root",n,a&&"nonLinear",r&&"alternativeLabel"]},it,s)},ct=F("div",{name:"MuiStepper",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:a}=e;return[n.root,n[a.orientation],a.alternativeLabel&&n.alternativeLabel,a.nonLinear&&n.nonLinear]}})({display:"flex",variants:[{props:{orientation:"horizontal"},style:{flexDirection:"row",alignItems:"center"}},{props:{orientation:"vertical"},style:{flexDirection:"column"}},{props:{alternativeLabel:!0},style:{alignItems:"flex-start"}}]}),pt=t.jsx(ot,{}),dt=i.forwardRef(function(n,a){const r=G({props:n,name:"MuiStepper"}),{activeStep:s=0,alternativeLabel:p=!1,children:g,className:d,component:o="div",connector:h=pt,nonLinear:b=!1,orientation:c="horizontal",...m}=r,N={...r,nonLinear:b,alternativeLabel:p,orientation:c,component:o},U=lt(N),C=i.Children.toArray(g).filter(Boolean),P=C.map((T,L)=>i.cloneElement(T,{index:L,last:L+1===C.length,...T.props})),E=i.useMemo(()=>({activeStep:s,alternativeLabel:p,connector:h,nonLinear:b,orientation:c}),[s,p,h,b,c]);return t.jsx(ee.Provider,{value:E,children:t.jsx(ct,{as:o,ownerState:N,className:z(U.root,d),ref:a,...m,children:P})})}),mt={Austria:/^ATU\d{9}$/,Belgium:/^BE[0-1]\d{9}$/,Bulgaria:/^BG\d{9,10}$/,Croatia:/^HR\d{11}$/,Cyprus:/^CY\d{8}[A-Z]$/,"Czech Republic":/^CZ\d{8,10}$/,Denmark:/^DK\d{8}$/,Estonia:/^EE\d{9}$/,Finland:/^FI\d{8}$/,France:/^FR[A-HJ-NP-Z0-9]{2}\d{9}$/,Germany:/^DE\d{9}$/,Greece:/^EL\d{9}$/,Hungary:/^HU\d{8}$/,Ireland:/^IE\d[A-Z0-9+*]\d{5}[A-Z]{1,2}$/,Italy:/^IT\d{11}$/,Latvia:/^LV\d{11}$/,Lithuania:/^LT(\d{9}|\d{12})$/,Luxembourg:/^LU\d{8}$/,Malta:/^MT\d{8}$/,Netherlands:/^NL\d{9}B\d{2}$/,Poland:/^PL\d{10}$/,Portugal:/^PT\d{9}$/,Romania:/^RO\d{2,10}$/,Slovakia:/^SK\d{10}$/,Slovenia:/^SI\d{8}$/,Spain:/^ES[A-Z0-9]\d{7}[A-Z0-9]$/};function ut(e,n){if(!e||!n)return!1;const a=e.replace(/\s+/g,"").toUpperCase(),r=mt[n];return r?r.test(a):!0}function de(e){return{Austria:"ATU12345678 (AT + U + 9 digits)",Belgium:"BE0123456789 (BE + 10 digits)",Bulgaria:"BG123456789 or BG1234567890 (BG + 9-10 digits)",Croatia:"HR12345678901 (HR + 11 digits)",Cyprus:"CY12345678A (CY + 8 digits + 1 letter)","Czech Republic":"CZ12345678 (CZ + 8-10 digits)",Denmark:"DK12345678 (DK + 8 digits)",Estonia:"EE123456789 (EE + 9 digits)",Finland:"FI12345678 (FI + 8 digits)",France:"FRAB123456789 (FR + 2 chars + 9 digits)",Germany:"DE123456789 (DE + 9 digits)",Greece:"EL123456789 (EL + 9 digits)",Hungary:"HU12345678 (HU + 8 digits)",Ireland:"IE1234567A or IE1A23456B (IE + 7-8 chars)",Italy:"IT12345678901 (IT + 11 digits)",Latvia:"LV12345678901 (LV + 11 digits)",Lithuania:"LT123456789 or LT123456789012 (LT + 9 or 12 digits)",Luxembourg:"LU12345678 (LU + 8 digits)",Malta:"MT12345678 (MT + 8 digits)",Netherlands:"NL123456789B01 (NL + 9 digits + B + 2 digits)",Poland:"PL1234567890 (PL + 10 digits)",Portugal:"PT123456789 (PT + 9 digits)",Romania:"RO1234567890 (RO + 2-10 digits)",Slovakia:"SK1234567890 (SK + 10 digits)",Slovenia:"SI12345678 (SI + 8 digits)",Spain:"ESA12345674 or ES12345678Z (ES + 9 chars)"}[e]||"Please enter a valid VAT number"}async function gt(){const e=await oe.get(B.pages.paymentPage.public);return e.data?.data||e.data}function ht(){const[e,n]=i.useState(null),[a,r]=i.useState(!0),[s,p]=i.useState(null),{i18n:g}=Le(),d=i.useCallback(async()=>{try{r(!0),p(null);const o=await gt();n(o)}catch(o){console.error("Failed to fetch public payment page:",o),p(o instanceof Error?o.message:"Failed to fetch payment page"),n({page_title:"Payment Information",page_content:"<p>Manage your payment information and billing details.</p>"})}finally{r(!1)}},[]);return i.useEffect(()=>{d()},[d,g.language]),{data:e,isLoading:a,error:s,refetch:d}}function xt({steps:e,activeStep:n}){return t.jsx(dt,{activeStep:n,alternativeLabel:!0,sx:{mb:5},children:e.map((a,r)=>t.jsx(Ve,{children:t.jsx(Se,{slots:{stepIcon:({active:s,completed:p})=>t.jsx(R,{sx:{width:24,height:24,display:"flex",borderRadius:"50%",alignItems:"center",color:"text.disabled",typography:"subtitle2",justifyContent:"center",bgcolor:"action.disabledBackground",...s&&{bgcolor:"primary.main",color:"primary.contrastText"},...p&&{bgcolor:"primary.main",color:"primary.contrastText"}},children:p?t.jsx(ie,{width:16,icon:"eva:checkmark-fill"}):t.jsx(R,{sx:{typography:"subtitle2"},children:r+1})})},children:a})},a))})}function bt(){const{t:e}=K("messages"),n=fe(),{setError:a,clearErrors:r,getValues:s}=n,[p,g]=i.useState(!1),[d,o]=i.useState(null),[h,b]=i.useState(null),[c,m]=i.useState(!1),[N,U]=i.useState(null),C=async()=>{const y=s("stepOne.email");if(!y){r("stepOne.email");return}try{await J(),!!(await X.post(B.auth.checkEmail,{email:y})).data?.exists?a("stepOne.email",{type:"duplicate",message:e("signUp.errors.emailExists")}):r("stepOne.email")}catch(j){const f=j?.message||e("signUp.errors.unableToValidateEmail");a("stepOne.email",{type:"manual",message:f})}},P=async()=>{const y=s("stepOne.phone");if(!y){r("stepOne.phone");return}try{await J(),!!(await X.post(B.auth.checkPhone,{phone:y})).data?.exists?a("stepOne.phone",{type:"duplicate",message:e("signUp.errors.phoneExists")}):r("stepOne.phone")}catch(j){const f=j?.message||e("signUp.errors.unableToValidatePhone");a("stepOne.phone",{type:"manual",message:f})}},E=async y=>{m(!0),U(null);try{const j=y==="privacy"?"/api/v1/public/pages/privacy-policy":"/api/v1/public/pages/terms-conditions",f=await oe.get(j,{baseURL:ve.serverUrl||void 0}),I=f?.data??f,l=I?.data??I,u=l?.page_title||l?.title||(y==="privacy"?"Privacy Policy":"Terms of Service"),x=l?.page_content||l?.content||"";b({title:u,content:x}),o(y),g(!0)}catch(j){console.error(`Failed to load ${y} page:`,j),U(j?.message||`Failed to load ${y==="privacy"?"privacy policy":"terms of service"}.`),b(null)}finally{m(!1)}},T=y=>{y.preventDefault(),E("privacy")},L=y=>{y.preventDefault(),E("terms")},w=()=>{g(!1),o(null),b(null),U(null)};return t.jsxs(t.Fragment,{children:[t.jsx($.Text,{name:"stepOne.firstName",label:e("signUp.stepOne.firstName"),variant:"filled",slotProps:{inputLabel:{shrink:!0}}}),t.jsx($.Text,{name:"stepOne.lastName",label:e("signUp.stepOne.lastName"),variant:"filled",slotProps:{inputLabel:{shrink:!0}}}),t.jsx($.Text,{name:"stepOne.email",label:e("signUp.stepOne.email"),type:"email",variant:"filled",slotProps:{inputLabel:{shrink:!0}},onBlur:C}),t.jsx(Me,{name:"stepOne.phone",label:e("signUp.stepOne.phone"),variant:"filled",slotProps:{inputLabel:{shrink:!0}},onBlur:P}),t.jsx($.Checkbox,{name:"stepOne.agreeToTerms",label:t.jsxs(t.Fragment,{children:[e("signUp.stepOne.agreeToTerms")," ",t.jsx(ce,{href:"#",onClick:T,sx:{cursor:"pointer"},children:e("signUp.stepOne.privacyPolicy")})," ",e("signUp.stepOne.and")," ",t.jsx(ce,{href:"#",onClick:L,sx:{cursor:"pointer"},children:e("signUp.stepOne.termsOfService")})]})}),t.jsxs(ge,{open:p,onClose:w,maxWidth:"md",fullWidth:!0,scroll:"paper",children:[t.jsx(he,{children:t.jsxs(Q,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[t.jsx(S,{variant:"h6",children:h?.title||(d==="privacy"?"Privacy Policy":"Terms of Service")}),t.jsx(Ue,{onClick:w,size:"small",children:t.jsx(ie,{icon:"solar:close-circle-bold"})})]})}),t.jsxs(xe,{dividers:!0,children:[c&&t.jsxs(Q,{alignItems:"center",spacing:2,sx:{py:6},children:[t.jsx(be,{size:32}),t.jsxs(S,{sx:{color:"text.secondary"},children:["Loading ",d==="privacy"?"privacy policy":"terms of service","â€¦"]})]}),N&&!c&&t.jsx(S,{align:"center",color:"error",sx:{mt:4},children:N}),!c&&!N&&h&&t.jsx($e,{content:h.content})]}),t.jsx(ye,{children:t.jsx(A,{onClick:w,variant:"contained",children:e("signUp.buttons.close")})})]})]})}function yt(){const{t:e}=K("messages"),n=fe(),{setError:a,clearErrors:r,getValues:s,watch:p}=n,g=p("stepTwo.country"),d=g&&Te.includes(g)&&g!=="Sweden",o=async()=>{const h=s("stepTwo.companyName");if(!h){r("stepTwo.companyName");return}try{await J(),!!(await X.post(B.auth.checkCompanyName,{companyName:h})).data?.exists?a("stepTwo.companyName",{type:"duplicate",message:e("signUp.errors.companyNameExists")}):r("stepTwo.companyName")}catch(b){const c=b?.message||e("signUp.errors.unableToValidateCompanyName");a("stepTwo.companyName",{type:"manual",message:c})}};return t.jsxs(t.Fragment,{children:[t.jsx($.Text,{name:"stepTwo.companyName",label:e("signUp.stepTwo.companyName"),variant:"filled",slotProps:{inputLabel:{shrink:!0}},onBlur:o}),t.jsxs(R,{sx:{position:"relative"},children:[t.jsx($.Text,{name:"stepTwo.companyNumber",label:e("signUp.stepTwo.companyNumber"),variant:"filled",slotProps:{inputLabel:{shrink:!0}}}),t.jsx(we,{title:e("signUp.stepTwo.companyNumberTooltip"),arrow:!0,children:t.jsx(ie,{icon:"eva:info-outline",sx:{position:"absolute",right:12,top:"50%",transform:"translateY(-50%)",cursor:"pointer",color:"text.disabled"}})})]}),t.jsx($.Text,{name:"stepTwo.address",label:e("signUp.stepTwo.address"),variant:"filled",slotProps:{inputLabel:{shrink:!0}}}),t.jsx($.Text,{name:"stepTwo.city",label:e("signUp.stepTwo.city"),variant:"filled",slotProps:{inputLabel:{shrink:!0}}}),t.jsx(Oe,{name:"stepTwo.country",label:e("signUp.stepTwo.country"),variant:"filled"}),d&&t.jsx($.Text,{name:"stepTwo.vatNumber",label:e("signUp.stepTwo.vatNumber"),variant:"filled",slotProps:{inputLabel:{shrink:!0},input:{placeholder:de(g)}},helperText:de(g)})]})}const Te=["Austria","Belgium","Bulgaria","Croatia","Cyprus","Czech Republic","Denmark","Estonia","Finland","France","Germany","Greece","Hungary","Ireland","Italy","Latvia","Lithuania","Luxembourg","Malta","Netherlands","Poland","Portugal","Romania","Slovakia","Slovenia","Spain","Sweden"];function vt({settings:e,selectedCountry:n,vatNumber:a,onComplete:r}){const{t:s}=K("messages"),p=Ne(),[g,d]=i.useState(!1),[o,h]=i.useState(null),[b,c]=i.useState(!1),{data:m,isLoading:N}=ht(),U=n?n.trim():"",C=U&&Te.includes(U),P=U==="Sweden",E=a&&a.trim().length>0;let T=0;(P||C&&!E)&&(T=e.vat_percentage||e.vat||25);const L=e.price||1e3,w=L*T/100,y=L+w,j=u=>{h(u),f(u,null)},f=async(u,x)=>{c(!0);try{await r(u,x),u==="bank"&&d(!0),c(!1)}catch{c(!1)}},I=()=>{d(!1),h(null)},l=()=>{d(!1),h(null),p.push("/")};return t.jsxs(ne,{container:!0,spacing:3,children:[t.jsx(ne,{size:{xs:12,md:6},children:t.jsx(re,{sx:{p:3},children:N?t.jsx(R,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:200},children:t.jsx(be,{})}):t.jsxs(t.Fragment,{children:[m?.page_title&&t.jsx(S,{variant:"h6",sx:{mb:2},children:m.page_title}),m?.page_content&&t.jsx(R,{sx:{"& h1, & h2, & h3, & h4, & h5, & h6":{color:"text.primary",fontWeight:600,mb:2,mt:3,"&:first-of-type":{mt:0}},"& h1":{fontSize:{xs:"1.5rem",md:"2rem"},mb:3},"& h2":{fontSize:{xs:"1.25rem",md:"1.5rem"}},"& h3":{fontSize:{xs:"1.125rem",md:"1.25rem"}},"& p":{color:"text.secondary",lineHeight:1.7,mb:2},"& ul, & ol":{pl:3,mb:2,"& li":{color:"text.secondary",lineHeight:1.7,mb:.5}},"& strong":{fontWeight:600,color:"text.primary"},"& a":{color:"primary.main",textDecoration:"none","&:hover":{textDecoration:"underline"}},"& img":{maxWidth:"100%",height:"auto",borderRadius:1,my:2}},dangerouslySetInnerHTML:{__html:m?.page_content||""}}),!m?.page_content&&!m?.page_title&&t.jsxs(t.Fragment,{children:[t.jsx(S,{variant:"h6",sx:{mb:2},children:s("signUp.stepThree.subscribeTitle")}),t.jsx(S,{variant:"body2",sx:{mb:3,color:"text.secondary"},children:s("signUp.stepThree.subscribeDescription")}),t.jsx(S,{variant:"subtitle2",sx:{mb:1,fontWeight:"bold"},children:s("signUp.stepThree.whyChooseUs")}),t.jsxs(R,{component:"ol",sx:{pl:2,mb:3},children:[t.jsxs(S,{component:"li",variant:"body2",sx:{mb:.5},children:[t.jsx("strong",{children:s("signUp.stepThree.confidentialReporting")}),":"," ",s("signUp.stepThree.confidentialReportingDesc")]}),t.jsxs(S,{component:"li",variant:"body2",sx:{mb:.5},children:[t.jsx("strong",{children:s("signUp.stepThree.userFriendlyInterface")}),":"," ",s("signUp.stepThree.userFriendlyInterfaceDesc")]}),t.jsxs(S,{component:"li",variant:"body2",sx:{mb:.5},children:[t.jsx("strong",{children:s("signUp.stepThree.securePlatform")}),":"," ",s("signUp.stepThree.securePlatformDesc")]}),t.jsxs(S,{component:"li",variant:"body2",sx:{mb:.5},children:[t.jsx("strong",{children:s("signUp.stepThree.comprehensiveReporting")}),":"," ",s("signUp.stepThree.comprehensiveReportingDesc")]})]}),t.jsx(S,{variant:"subtitle2",sx:{mb:1,fontWeight:"bold"},children:s("signUp.stepThree.keyFeatures")}),t.jsx(S,{variant:"body2",sx:{color:"text.secondary"},children:s("signUp.stepThree.userAuthentication")})]})]})})}),t.jsx(ne,{size:{xs:12,md:6},children:t.jsxs(re,{sx:{p:3},children:[t.jsx(S,{variant:"h6",sx:{mb:2},children:s("signUp.stepThree.orderSummary")}),t.jsxs(Q,{spacing:2,children:[t.jsxs(R,{sx:{display:"flex",justifyContent:"space-between"},children:[t.jsx(S,{variant:"body2",children:s("signUp.stepThree.subscription")}),t.jsxs(S,{variant:"body2",children:["$",L.toFixed(2)]})]}),t.jsxs(R,{sx:{display:"flex",justifyContent:"space-between"},children:[t.jsxs(S,{variant:"body2",children:[s("signUp.stepThree.vat")," ",T>0?`${T}%`:"0%"]}),t.jsxs(S,{variant:"body2",children:["$",w.toFixed(2)]})]}),t.jsx(Pe,{}),t.jsxs(R,{sx:{display:"flex",justifyContent:"space-between"},children:[t.jsx(S,{variant:"subtitle1",sx:{fontWeight:"bold"},children:s("signUp.stepThree.total")}),t.jsxs(S,{variant:"subtitle1",sx:{fontWeight:"bold"},children:["$",y.toFixed(2)]})]})]}),t.jsxs(Q,{spacing:2,sx:{mt:3},children:[t.jsx(A,{fullWidth:!0,variant:"contained",size:"large",onClick:()=>j("card"),disabled:b,children:s("signUp.stepThree.payWithCard")}),t.jsx(A,{fullWidth:!0,variant:"outlined",size:"large",onClick:()=>j("bank"),disabled:b,children:s("signUp.stepThree.bankTransfer")})]})]})}),t.jsxs(ge,{open:g,onClose:I,scroll:"body",maxWidth:"sm",fullWidth:!0,children:[t.jsx(he,{children:s(o==="card"?"signUp.stepThree.paymentConfirmation":"signUp.stepThree.bankTransferDetails")}),t.jsx(xe,{sx:{color:"text.secondary"},children:o==="card"?t.jsxs(t.Fragment,{children:[s("signUp.stepThree.cardPaymentMessage"),t.jsx("br",{}),t.jsx("br",{}),s("signUp.stepThree.thankYou")]}):t.jsxs(t.Fragment,{children:[s("signUp.stepThree.bankTransferMessage"),t.jsx("br",{}),t.jsx("br",{}),s("signUp.stepThree.thankYou")]})}),t.jsx(ye,{children:t.jsx(A,{variant:"contained",onClick:l,autoFocus:!0,children:s("signUp.stepThree.backToHome")})})]})]})}function ft(){const{t:e,i18n:n}=K("messages"),a=[e("signUp.steps.personalDetails"),e("signUp.steps.companyDetails"),e("signUp.steps.paymentSummary")],r=()=>Y({firstName:M().min(2,{message:e("signUp.validation.firstNameRequired")}),lastName:M().min(2,{message:e("signUp.validation.lastNameRequired")}),email:ke.email(),phone:M().min(10,{message:e("signUp.validation.phoneRequired")}),agreeToTerms:De().refine(l=>l===!0,{message:e("signUp.validation.agreeToTermsRequired")})}),s=()=>{const l=["Austria","Belgium","Bulgaria","Croatia","Cyprus","Czech Republic","Denmark","Estonia","Finland","France","Germany","Greece","Hungary","Ireland","Italy","Latvia","Lithuania","Luxembourg","Malta","Netherlands","Poland","Portugal","Romania","Slovakia","Slovenia","Spain"];return Y({companyName:M().min(2,{message:e("signUp.validation.companyNameRequired")}),companyNumber:M().min(1,{message:e("signUp.validation.companyNumberRequired")}),address:M().min(5,{message:e("signUp.validation.addressRequired")}),city:M().min(2,{message:e("signUp.validation.cityRequired")}),country:M().min(1,{message:e("signUp.validation.countryRequired")}),vatNumber:M().optional()}).refine(u=>!u.vatNumber||u.vatNumber.trim().length===0||u.country==="Sweden"||!l.includes(u.country)?!0:ut(u.vatNumber,u.country),{message:e("signUp.validation.vatNumberFormatInvalid"),path:["vatNumber"]})},p=()=>Y({paymentMethod:Ae(["card","bank"],{message:e("signUp.validation.paymentMethodRequired")})}),g=Y({stepOne:r(),stepTwo:s(),stepThree:p()}),d={stepOne:{firstName:"",lastName:"",email:"",phone:"",agreeToTerms:!1},stepTwo:{companyName:"",companyNumber:"",address:"",city:"",country:"",vatNumber:""},stepThree:{paymentMethod:"card"}},[o,h]=i.useState(0),[b,c]=i.useState({vat:25,price:1e3,vat_percentage:25}),m=Ie({mode:"onChange",resolver:Re(g),defaultValues:d}),{trigger:N,handleSubmit:U,setError:C,formState:{isSubmitting:P,isValidating:E,errors:T}}=m,L=i.useCallback(async l=>{if(l){const u=l==="stepOne"?T?.stepOne:T?.stepTwo,x=u?.email,v=u?.phone,k=x&&(x.type==="duplicate"||x.type==="manual"),O=v&&(v.type==="duplicate"||v.type==="manual");if(k||O)return;const _=await N(l);if(l==="stepOne"&&(k&&x&&C("stepOne.email",{type:x.type,message:x.message||e("signUp.errors.emailExists")}),O&&v&&C("stepOne.phone",{type:v.type,message:v.message||e("signUp.errors.phoneExists")})),!_)return;const V=l==="stepOne"?m.formState.errors?.stepOne:m.formState.errors?.stepTwo;if(V&&Object.keys(V).length>0)return;h(je=>je+1)}else h(u=>u+1)},[N,T,m,C,e]),w=i.useCallback(()=>{h(l=>l-1)},[]),y=i.useCallback(async(l,u)=>{const x=m.getValues();try{await J();const v=new FormData;v.append("firstName",x.stepOne.firstName),v.append("lastName",x.stepOne.lastName),v.append("email",x.stepOne.email),v.append("phone",x.stepOne.phone),v.append("companyName",x.stepTwo.companyName),v.append("companyNumber",x.stepTwo.companyNumber),v.append("address",x.stepTwo.address),v.append("city",x.stepTwo.city),v.append("country",x.stepTwo.country),x.stepTwo.vatNumber&&v.append("vatNumber",x.stepTwo.vatNumber),v.append("paymentMethod",l),u&&v.append("paymentAttachment",u);const O=(n.language||n.resolvedLanguage||localStorage.getItem("i18nextLng")||"en").split("-")[0].toLowerCase();v.append("user_language",O);const _=await X.post(B.auth.signup,v,{headers:{"Content-Type":"multipart/form-data"}});if(l==="card"){const V=_.data?.checkout_url;V&&(window.location.href=V)}}catch(v){const k=v?.response?.data;if(k?.errors&&typeof k.errors=="object"&&k.errors.vatNumber&&Array.isArray(k.errors.vatNumber)&&k.errors.vatNumber.length>0)throw C("stepTwo.vatNumber",{type:"manual",message:e("signUp.validation.vatNumberFormatInvalid")}),h(1),new Error(e("signUp.errors.signupFailed"));const O=v?.message||e("signUp.errors.signupFailed");throw new Error(O)}},[m,e,C,h,n.language,n.resolvedLanguage]),j=U(async l=>{}),f=o===a.length;i.useEffect(()=>{(async()=>{try{const u=await oe.get(B.settings),x=u.data?.data||u.data||{};c({vat:x.vat||25,price:x.price||1e3,vat_percentage:x.vat_percentage||x.vat||25})}catch(u){console.error("Failed to fetch settings:",u),c({vat:25,price:1e3,vat_percentage:25})}})()},[]);const I=i.useMemo(()=>{const l=T,u=o===0?l?.stepOne:o===1?l?.stepTwo:l?.stepThree;return u?Object.keys(u).length>0:!1},[o,T]);return t.jsxs(re,{sx:{p:5,width:1,mx:"auto",maxWidth:720},children:[t.jsx(xt,{steps:a,activeStep:o}),t.jsxs(Fe,{methods:m,onSubmit:j,children:[t.jsxs(R,{sx:[l=>({p:3,mb:3,gap:3,minHeight:240,display:"flex",borderRadius:1.5,flexDirection:"column",border:`dashed 1px ${l.vars.palette.divider}`})],children:[o===0&&t.jsx(bt,{}),o===1&&t.jsx(yt,{}),o===2&&t.jsx(vt,{settings:b,selectedCountry:m.watch("stepTwo.country"),vatNumber:m.watch("stepTwo.vatNumber"),onComplete:y})]}),!f&&o<a.length-1&&t.jsxs(R,{sx:{display:"flex"},children:[o!==0&&t.jsx(A,{onClick:w,children:e("signUp.buttons.back")}),t.jsx(R,{sx:{flex:"1 1 auto"}}),o===0&&t.jsx(A,{type:"submit",variant:"contained",onClick:()=>L("stepOne"),disabled:I||P||E,children:e("signUp.buttons.next")}),o===1&&t.jsx(A,{type:"submit",variant:"contained",onClick:()=>L("stepTwo"),disabled:I||P||E,children:e("signUp.buttons.next")})]}),o===a.length-1&&!f&&t.jsxs(R,{sx:{display:"flex"},children:[t.jsx(A,{onClick:w,children:e("signUp.buttons.back")}),t.jsx(R,{sx:{flex:"1 1 auto"}})]})]})]})}function St(){const{t:e}=K("messages");return t.jsxs(Ee,{sx:{py:{xs:3,md:5}},children:[t.jsx(S,{variant:"h3",align:"center",sx:{mb:2},children:e("signUp.title")}),t.jsx(S,{align:"center",sx:{color:"text.secondary",mb:5},children:e("signUp.description")}),t.jsx(ft,{})]})}const Tt={title:`Sign Up - ${ve.appName}`};function Qt(){return t.jsxs(t.Fragment,{children:[t.jsx("title",{children:Tt.title}),t.jsx(St,{})]})}export{Qt as default};
