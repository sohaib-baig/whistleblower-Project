import{w as _,u as q,r as f,a4 as j,a0 as P,p as G,j as a,B as s,T as i,a8 as J,a7 as C,I as w,a6 as K,a3 as N,M as p,a5 as O,c as x}from"./index-BJkBHIXD.js";import{a as Q}from"./index.esm-DG78EUPk.js";import{a as X}from"./zod-DbnPk1Kl.js";import{u as Y,a as Z}from"./privacy-policy-YT0BRm3M.js";import{F as d}from"./fields-wQ2IQIfM.js";import{s as $}from"./schema-utils-C_-d4BNQ.js";import{F as aa}from"./form-provider-BYLnCB41.js";import{S as h}from"./Stack-DSqJGNfN.js";import{C as S}from"./Card-CU8jzKuK.js";import{C as ea}from"./CardHeader-BmHD0Q2N.js";import{o as ta,s as y}from"./schemas-BaSQ7w8v.js";const sa=r=>ta({title:y().min(5,{message:r("dashboard.privacyPolicy.errors.titleMinLength")}),content:$.editor().min(20,{message:r("dashboard.privacyPolicy.errors.contentMinLength")}),status:y().optional(),language:y().optional()});function xa({isReportingLinkContext:r=!1}){const{t:e}=_("navbar"),v=q(),[n,I]=f.useState("en"),{data:o,isLoading:k,refetch:L}=Y(n),F=Z(),H=sa(e),l=j(),m=j(!0),E={title:"",content:"",status:"active",language:"en"},g=Q({mode:"all",resolver:X(H),defaultValues:E,values:o?{title:o.title,content:o.content,status:o.status||"active",language:o.language||n}:void 0}),{watch:T,setValue:B,handleSubmit:M,formState:{isSubmitting:z,isValid:b}}=g,c=T(),D=t=>{I(t),B("language",t),L()},W=M(async t=>{try{await F.mutateAsync({...t,language:n}),P.success(e(r?"dashboard.reportingLink.page1.updatedSuccessfully":"dashboard.privacyPolicy.toast.updatedSuccessfully"))}catch(u){console.error(u),P.error(e("dashboard.privacyPolicy.toast.updateFailed"))}}),V=f.useCallback(()=>{v.push(G.dashboard.privacyPolicy.root)},[v]),A=(t,u)=>a.jsx(C,{onClick:u,children:a.jsx(w,{icon:t?"eva:arrow-ios-downward-fill":"eva:arrow-ios-forward-fill"})}),R=()=>a.jsxs(S,{children:[a.jsx(ea,{title:e("dashboard.privacyPolicy.form.title"),subheader:e("dashboard.privacyPolicy.form.subheader"),action:A(m.value,m.onToggle),sx:{mb:3}}),a.jsx(K,{}),a.jsxs(h,{spacing:3,sx:{p:3},children:[a.jsx(d.Text,{name:"title",label:e("dashboard.privacyPolicy.form.titleLabel")}),a.jsx(d.Select,{name:"language",label:"Language",value:n,onChange:t=>D(t.target.value),children:N.map(t=>a.jsx(p,{value:t.value,children:t.label},t.value))}),a.jsxs(d.Select,{name:"status",label:e("dashboard.privacyPolicy.form.status"),placeholder:e("dashboard.privacyPolicy.form.selectStatus"),children:[a.jsx(p,{value:"active",children:e("dashboard.privacyPolicy.status.active")}),a.jsx(p,{value:"inactive",children:e("dashboard.privacyPolicy.status.inactive")})]}),a.jsx(O,{in:m.value,children:a.jsxs(h,{spacing:1.5,children:[a.jsx(i,{variant:"subtitle2",children:e("dashboard.privacyPolicy.form.content")}),a.jsx(d.Editor,{name:"content",fullItem:!0,sx:{maxHeight:600,"& .ql-editor":{minHeight:400}}}),a.jsx(i,{variant:"caption",color:"text.secondary",sx:{mt:1},children:e("dashboard.privacyPolicy.form.tip")})]})})]})]}),U=()=>a.jsxs(s,{sx:{display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"flex-end",gap:2,p:2.5},children:[a.jsx(x,{color:"inherit",variant:"outlined",size:"medium",onClick:l.onTrue,disabled:!b,children:e("dashboard.privacyPolicy.actions.preview")}),a.jsx(x,{color:"inherit",variant:"outlined",size:"medium",onClick:V,children:e("dashboard.privacyPolicy.actions.cancel")}),a.jsx(x,{type:"submit",variant:"contained",size:"medium",loading:z,disabled:!b,children:e("dashboard.privacyPolicy.actions.saveChanges")})]});return k?a.jsx(s,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400},children:a.jsx(i,{children:e("dashboard.privacyPolicy.loading")})}):a.jsxs(aa,{methods:g,onSubmit:W,children:[a.jsxs(h,{spacing:5,sx:{mx:"auto",maxWidth:{xs:720,xl:880}},children:[R(),U()]}),l.value&&a.jsx(J,{children:a.jsx(s,{onClick:l.onFalse,sx:{position:"fixed",top:0,left:0,right:0,bottom:0,bgcolor:"rgba(0, 0, 0, 0.5)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",p:2},children:a.jsxs(S,{onClick:t=>t.stopPropagation(),sx:{width:"100%",maxWidth:{xs:"95vw",sm:"90vw",md:"800px",lg:"1000px"},maxHeight:"90vh",display:"flex",flexDirection:"column",position:"relative"},children:[a.jsx(s,{sx:{p:2,borderBottom:1,borderColor:"divider",flexShrink:0},children:a.jsxs(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[a.jsx(i,{variant:"h6",children:e("dashboard.privacyPolicy.actions.preview")}),a.jsx(C,{onClick:l.onFalse,children:a.jsx(w,{icon:"solar:close-circle-bold"})})]})}),a.jsxs(s,{sx:{p:3,overflow:"auto",flex:1},children:[c.title&&a.jsx(i,{variant:"h4",sx:{mb:2},children:c.title}),c.content?a.jsx(s,{sx:{"& h1, & h2, & h3, & h4, & h5, & h6":{color:"text.primary",fontWeight:600,mb:2,mt:3,"&:first-of-type":{mt:0}},"& p":{color:"text.secondary",lineHeight:1.7,mb:2},"& ul, & ol":{pl:3,mb:2,"& li":{color:"text.secondary",lineHeight:1.7,mb:.5}}},dangerouslySetInnerHTML:{__html:c.content}}):a.jsx(i,{variant:"body2",color:"text.secondary",children:e("dashboard.privacyPolicy.form.noContent")})]})]})})})]})}export{xa as P};
