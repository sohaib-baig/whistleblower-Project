import{i as S,s as x,e as D,w as f,r as b,a0 as m,j as e,B as h,c as u,T as y,W as w,aa as B,p}from"./index-BJkBHIXD.js";import{a as T}from"./index.esm-DG78EUPk.js";import{a as C}from"./zod-DbnPk1Kl.js";import{F as i}from"./fields-wQ2IQIfM.js";import{F as E}from"./form-provider-BYLnCB41.js";import{S as I}from"./Stack-DSqJGNfN.js";import{o as F,s as o}from"./schemas-BaSQ7w8v.js";import{G as k}from"./Grid-D_Et280v.js";import{C as Z}from"./Card-CU8jzKuK.js";import"./text-transform-DM798QSo.js";import"./TextField-BfOXJaKd.js";import"./Select-CM-FquqI.js";import"./index-BdCJuPE0.js";import"./rhf-phone-input-DvY4aKGv.js";import"./index-CDpvdXdB.js";import"./search-not-found-BYtFGFNz.js";import"./InputAdornment-Cyf39fZQ.js";import"./rhf-text-field-D45rQogC.js";import"./RadioGroup-eX8WPtuC.js";import"./FormControlLabel-Do9AncA_.js";import"./Autocomplete-vOabT0lM.js";import"./Chip-Cd7PxQUv.js";import"./rhf-select-BCHEEYe2.js";import"./styles-B-zEs6qR.js";import"./format-number-BErDzwe7.js";import"./upload-default-BMHhCMpu.js";import"./tslib.es6-CTYbIaVE.js";import"./DatePicker-D3hVcc_W.js";async function G(){try{const a=(await x.get(D.bankDetails.get)).data||{};return{id:"admin-settings",iban:a.iban||"",bic:a.bic_code||"",bankAccount:a.bank_account||"",isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}catch(t){return console.error("Error loading bank details:",t),null}}async function O(t){try{return await S(),await x.put(D.bankDetails.update,{iban:t.iban,bic_code:t.bic,bank_account:t.bankAccount}),{id:"admin-settings",...t,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}catch(a){throw console.error("Error saving bank details:",a),new Error("Failed to save bank details")}}function P({onSuccess:t}){const{t:a}=f("navbar"),[n,d]=b.useState(!1),g=F({iban:o().min(1,a("dashboard.bankDetails.validation.ibanRequired")).regex(/^[A-Z]{2}[0-9]{2}[A-Z0-9 ]{8,30}$/i,a("dashboard.bankDetails.validation.ibanInvalid")),bic:o().min(1,a("dashboard.bankDetails.validation.bicRequired")).regex(/^[A-Z]{4}[A-Z]{2}[A-Z0-9]{2}([A-Z0-9]{3})?$/i,a("dashboard.bankDetails.validation.bicInvalid")),bankAccount:o().min(1,a("dashboard.bankDetails.validation.bankAccountRequired")).regex(/^[A-Za-z0-9 -]{4,64}$/i,a("dashboard.bankDetails.validation.bankAccountInvalid"))}),c=T({resolver:C(g),defaultValues:{iban:"",bic:"",bankAccount:""}}),{reset:s,handleSubmit:v}=c;b.useEffect(()=>{(async()=>{try{const r=await G();r&&s({iban:r.iban,bic:r.bic,bankAccount:r.bankAccount})}catch(r){console.error("Error loading bank details:",r)}})()},[s]);const A=v(async l=>{try{d(!0),await O(l),m.success(a("dashboard.bankDetails.toast.saveSuccess")),t?.()}catch{m.error(a("dashboard.bankDetails.toast.saveError"))}finally{d(!1)}}),j=()=>{s()};return e.jsxs(E,{methods:c,onSubmit:A,children:[e.jsxs(h,{sx:{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[e.jsx(i.Text,{name:"iban",label:a("dashboard.bankDetails.form.iban"),placeholder:a("dashboard.bankDetails.form.ibanPlaceholder"),helperText:a("dashboard.bankDetails.form.ibanHelperText")}),e.jsx(i.Text,{name:"bic",label:a("dashboard.bankDetails.form.bic"),placeholder:a("dashboard.bankDetails.form.bicPlaceholder"),helperText:a("dashboard.bankDetails.form.bicHelperText")}),e.jsx(i.Text,{name:"bankAccount",label:a("dashboard.bankDetails.form.bankAccount"),placeholder:a("dashboard.bankDetails.form.bankAccountPlaceholder"),helperText:a("dashboard.bankDetails.form.bankAccountHelperText"),sx:{gridColumn:"1 / -1"}})]}),e.jsxs(I,{direction:"row",spacing:2,sx:{mt:3,alignItems:"flex-end"},children:[e.jsx(u,{type:"submit",variant:"contained",loading:n,disabled:n,children:a("dashboard.bankDetails.form.saveBankDetails")}),e.jsx(u,{variant:"outlined",onClick:j,disabled:n,children:a("dashboard.bankDetails.form.cancel")})]}),e.jsx(h,{sx:{mt:3},children:e.jsxs(y,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:a("dashboard.bankDetails.form.securityNote")})," ",a("dashboard.bankDetails.form.securityNoteText")]})})]})}function R(){const{t}=f("navbar"),a=()=>{};return e.jsxs(w,{children:[e.jsx(B,{heading:t("dashboard.bankDetails.heading"),links:[{name:"Dashboard",href:p.dashboard.overview.analytics},{name:"Settings",href:p.dashboard.user.root},{name:t("dashboard.bankDetails.breadcrumb")}],sx:{mb:{xs:3,md:5}}}),e.jsx(k,{container:!0,spacing:3,children:e.jsx(k,{size:{xs:12},children:e.jsx(Z,{sx:{p:3},children:e.jsx(P,{onSuccess:a})})})})]})}function ha(){return e.jsx(R,{})}export{ha as default};
