import{w as H,r as p,bV as O,a0 as w,j as e,B as s,T as b,c as n,bt as G,M as h,bW as A,W as U,aa as _,p as L}from"./index-BJkBHIXD.js";import{a as $}from"./index.esm-DG78EUPk.js";import{a as Y}from"./zod-DbnPk1Kl.js";import{F as r}from"./fields-wQ2IQIfM.js";import{F as q}from"./form-provider-BYLnCB41.js";import{S as P}from"./Stack-DSqJGNfN.js";import{F as J}from"./FormControlLabel-Do9AncA_.js";import{o as K,c as Q,n as d,b as X,s as y,j as D}from"./schemas-BaSQ7w8v.js";import{G as B}from"./Grid-D_Et280v.js";import{C as Z}from"./Card-CU8jzKuK.js";import"./text-transform-DM798QSo.js";import"./TextField-BfOXJaKd.js";import"./Select-CM-FquqI.js";import"./index-BdCJuPE0.js";import"./rhf-phone-input-DvY4aKGv.js";import"./index-CDpvdXdB.js";import"./search-not-found-BYtFGFNz.js";import"./InputAdornment-Cyf39fZQ.js";import"./rhf-text-field-D45rQogC.js";import"./RadioGroup-eX8WPtuC.js";import"./Autocomplete-vOabT0lM.js";import"./Chip-Cd7PxQUv.js";import"./rhf-select-BCHEEYe2.js";import"./styles-B-zEs6qR.js";import"./format-number-BErDzwe7.js";import"./upload-default-BMHhCMpu.js";import"./tslib.es6-CTYbIaVE.js";import"./DatePicker-D3hVcc_W.js";function ee({onSuccess:c}){const{t:o}=H("navbar"),[g,S]=p.useState(!1),[C,m]=p.useState(null),[x,u]=p.useState(null),E=K({logo:D(File).optional().refine(i=>!i||i.size<=5*1024*1024,o("dashboard.basicConfiguration.validation.fileSizeError")).refine(i=>!i||i.type.startsWith("image/"),o("dashboard.basicConfiguration.validation.fileTypeError")),smallLogo:D(File).optional().refine(i=>!i||i.size<=5*1024*1024,o("dashboard.basicConfiguration.validation.fileSizeError")).refine(i=>!i||i.type.startsWith("image/"),o("dashboard.basicConfiguration.validation.fileTypeError")),defaultOpenStateDeadline:d().min(1,o("dashboard.basicConfiguration.validation.deadlineMin")).max(365,o("dashboard.basicConfiguration.validation.deadlineMax")),defaultClosedStateDeadline:d().min(1,o("dashboard.basicConfiguration.validation.deadlineMin")).max(365,o("dashboard.basicConfiguration.validation.deadlineMax")),invoiceNote:y().max(500,o("dashboard.basicConfiguration.validation.invoiceNoteMax")).optional(),vat:d().min(0,o("dashboard.basicConfiguration.validation.vatMin")).max(100,o("dashboard.basicConfiguration.validation.vatMax")),price:d().min(0,o("dashboard.basicConfiguration.validation.priceMin")),phoneHoursFrom:y().regex(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/,o("dashboard.basicConfiguration.validation.timeFormatError")),phoneHoursTo:y().regex(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/,o("dashboard.basicConfiguration.validation.timeFormatError")),deleteClosedCases:X(),deleteClosedCasesPeriod:d().min(1).optional().nullable(),deleteClosedCasesPeriodType:Q(["daily","weekly","monthly","yearly"]).optional().nullable()}),T=$({resolver:Y(E),defaultValues:{defaultOpenStateDeadline:30,defaultClosedStateDeadline:90,invoiceNote:"",vat:0,price:0,phoneHoursFrom:"09:00",phoneHoursTo:"17:00",deleteClosedCases:!1,deleteClosedCasesPeriod:null,deleteClosedCasesPeriodType:null}}),{reset:v,handleSubmit:k,watch:F,register:M,setValue:f}=T;p.useEffect(()=>{(async()=>{try{const a=await A();a&&(v({defaultOpenStateDeadline:a.defaultOpenStateDeadline,defaultClosedStateDeadline:a.defaultClosedStateDeadline,invoiceNote:a.invoiceNote||"",vat:a.vat,price:a.price,phoneHoursFrom:a.phoneHoursFrom,phoneHoursTo:a.phoneHoursTo,deleteClosedCases:a.deleteClosedCases,deleteClosedCasesPeriod:a.deleteClosedCasesPeriod||null,deleteClosedCasesPeriodType:a.deleteClosedCasesPeriodType||null}),a.logo&&m(a.logo),a.smallLogo&&u(a.smallLogo))}catch(a){console.error("Error loading configuration:",a)}})()},[v]);const I=k(async i=>{try{S(!0),await O(i),w.success(o("dashboard.basicConfiguration.toast.saveSuccess")),c?.()}catch{w.error(o("dashboard.basicConfiguration.toast.saveError"))}finally{S(!1)}}),R=i=>{const a=i.target.files?.[0];if(a){f("logo",a,{shouldValidate:!0});const t=new FileReader;t.onload=j=>{const l=j.target?.result;typeof l=="string"&&m(l)},t.readAsDataURL(a)}},N=()=>{m(null);const i=document.getElementById("logo-upload");i&&(i.value=""),f("logo",void 0,{shouldValidate:!0})},V=i=>{const a=i.target.files?.[0];if(a){f("smallLogo",a,{shouldValidate:!0});const t=new FileReader;t.onload=j=>{const l=j.target?.result;typeof l=="string"&&u(l)},t.readAsDataURL(a)}},z=()=>{u(null);const i=document.getElementById("small-logo-upload");i&&(i.value=""),f("smallLogo",void 0,{shouldValidate:!0})},W=()=>{v(),m(null),u(null)};return e.jsxs(q,{methods:T,onSubmit:I,children:[e.jsxs(s,{sx:{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[e.jsx(s,{sx:{gridColumn:"1 / -1"},children:e.jsxs(P,{direction:{xs:"column",sm:"row"},spacing:3,sx:{width:"100%"},children:[e.jsxs(s,{sx:{flex:1},children:[e.jsx(b,{variant:"subtitle2",sx:{mb:1},children:o("dashboard.basicConfiguration.form.companyLogo")}),e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[e.jsx("input",{type:"file",accept:"image/*",onChange:R,style:{display:"none"},id:"logo-upload"}),e.jsx("label",{htmlFor:"logo-upload",children:e.jsx(n,{variant:"outlined",component:"span",children:o(C?"dashboard.basicConfiguration.form.changeLogo":"dashboard.basicConfiguration.form.uploadLogo")})}),C&&e.jsxs(e.Fragment,{children:[e.jsx(s,{component:"img",src:C,alt:"Logo preview",sx:{width:100,height:100,objectFit:"contain",border:"1px solid #e0e0e0",borderRadius:1}}),e.jsx(n,{variant:"outlined",color:"error",size:"small",onClick:N,children:o("dashboard.basicConfiguration.form.remove")})]})]})]}),e.jsxs(s,{sx:{flex:1},children:[e.jsx(b,{variant:"subtitle2",sx:{mb:1},children:o("dashboard.basicConfiguration.form.smallCompanyLogo")}),e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[e.jsx("input",{type:"file",accept:"image/*",onChange:V,style:{display:"none"},id:"small-logo-upload"}),e.jsx("label",{htmlFor:"small-logo-upload",children:e.jsx(n,{variant:"outlined",component:"span",children:o(x?"dashboard.basicConfiguration.form.changeLogo":"dashboard.basicConfiguration.form.uploadLogo")})}),x&&e.jsxs(e.Fragment,{children:[e.jsx(s,{component:"img",src:x,alt:"Small logo preview",sx:{width:100,height:100,objectFit:"contain",border:"1px solid #e0e0e0",borderRadius:1}}),e.jsx(n,{variant:"outlined",color:"error",size:"small",onClick:z,children:o("dashboard.basicConfiguration.form.remove")})]})]})]})]})}),e.jsx(r.Text,{name:"defaultOpenStateDeadline",label:o("dashboard.basicConfiguration.form.defaultOpenStateDeadline"),type:"number",inputProps:{min:1,max:365}}),e.jsx(r.Text,{name:"defaultClosedStateDeadline",label:o("dashboard.basicConfiguration.form.defaultClosedStateDeadline"),type:"number",inputProps:{min:1,max:365}}),e.jsx(r.Text,{name:"vat",label:o("dashboard.basicConfiguration.form.vat"),type:"number",inputProps:{min:0,max:100,step:.01}}),e.jsx(r.Text,{name:"price",label:o("dashboard.basicConfiguration.form.defaultPrice"),type:"number",inputProps:{min:0,step:.01}}),e.jsx(r.Text,{name:"phoneHoursFrom",label:o("dashboard.basicConfiguration.form.phoneHoursFrom"),type:"time",InputLabelProps:{shrink:!0}}),e.jsx(r.Text,{name:"phoneHoursTo",label:o("dashboard.basicConfiguration.form.phoneHoursTo"),type:"time",InputLabelProps:{shrink:!0}}),e.jsx(r.Text,{name:"invoiceNote",label:o("dashboard.basicConfiguration.form.invoiceNote"),multiline:!0,rows:3,helperText:o("dashboard.basicConfiguration.form.invoiceNoteHelperText")}),e.jsxs(s,{sx:{gridColumn:"1 / -1"},children:[e.jsx(J,{control:e.jsx(G,{...M("deleteClosedCases"),checked:F("deleteClosedCases")}),label:o("dashboard.basicConfiguration.form.deleteClosedCases")}),e.jsx(b,{variant:"caption",color:"text.secondary",sx:{ml:4},children:o("dashboard.basicConfiguration.form.deleteClosedCasesHelperText")})]}),F("deleteClosedCases")&&e.jsxs(e.Fragment,{children:[e.jsx(r.Text,{name:"deleteClosedCasesPeriod",label:o("dashboard.basicConfiguration.form.deleteClosedCasesPeriod"),type:"number",inputProps:{min:1}}),e.jsxs(r.Select,{name:"deleteClosedCasesPeriodType",label:o("dashboard.basicConfiguration.form.deleteClosedCasesPeriodType"),children:[e.jsx(h,{value:"daily",children:o("dashboard.basicConfiguration.form.periodDaily")}),e.jsx(h,{value:"weekly",children:o("dashboard.basicConfiguration.form.periodWeekly")}),e.jsx(h,{value:"monthly",children:o("dashboard.basicConfiguration.form.periodMonthly")}),e.jsx(h,{value:"yearly",children:o("dashboard.basicConfiguration.form.periodYearly")})]})]})]}),e.jsxs(P,{direction:"row",spacing:2,sx:{mt:3,alignItems:"flex-end"},children:[e.jsx(n,{type:"submit",variant:"contained",loading:g,disabled:g,children:o("dashboard.basicConfiguration.form.saveConfiguration")}),e.jsx(n,{variant:"outlined",onClick:W,disabled:g,children:o("dashboard.basicConfiguration.form.cancel")})]}),e.jsx(s,{sx:{mt:3},children:e.jsxs(b,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:o("dashboard.basicConfiguration.form.note")})," ",o("dashboard.basicConfiguration.form.noteText")]})})]})}function oe(){const{t:c}=H("navbar"),o=()=>{};return e.jsxs(U,{children:[e.jsx(_,{heading:c("dashboard.basicConfiguration.heading"),links:[{name:"Dashboard",href:L.dashboard.overview.analytics},{name:"Settings",href:L.dashboard.user.root},{name:c("dashboard.basicConfiguration.breadcrumb")}],sx:{mb:{xs:3,md:5}}}),e.jsx(B,{container:!0,spacing:3,children:e.jsx(B,{size:{xs:12},children:e.jsx(Z,{sx:{p:3},children:e.jsx(ee,{onSuccess:o})})})})]})}function He(){return e.jsx(oe,{})}export{He as default};
