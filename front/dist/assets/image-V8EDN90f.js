import{bD as C,r as f,j as I,bE as R,bF as T}from"./index-BJkBHIXD.js";import{I as V,i as g,a as N,b as O,c as k}from"./styles-CIBYb4dP.js";const S={some:0,all:1};function U(t,r,{root:d,margin:c,amount:s="some"}={}){const u=C(t),a=new WeakMap,n=l=>{l.forEach(e=>{const o=a.get(e.target);if(e.isIntersecting!==!!o)if(e.isIntersecting){const m=r(e.target,e);typeof m=="function"?a.set(e.target,m):i.unobserve(e.target)}else typeof o=="function"&&(o(e),a.delete(e.target))})},i=new IntersectionObserver(n,{root:d,rootMargin:c,threshold:typeof s=="number"?s:S[s]});return u.forEach(l=>i.observe(l)),()=>i.disconnect()}function _(t,{root:r,margin:d,amount:c,once:s=!1,initial:u=!1}={}){const[a,n]=f.useState(u);return f.useEffect(()=>{if(!t.current||s&&a)return;const i=()=>(n(!0),s?void 0:()=>n(!1)),l={root:r&&r.current||void 0,margin:d,amount:c};return U(t.current,i,l)},[r,t,d,s,c]),a}const D=0,M={style:"blur",duration:300,disabled:!1};function q({sx:t,src:r,ref:d,ratio:c,onLoad:s,effect:u,alt:a="",slotProps:n,className:i,viewportOptions:l,disablePlaceholder:e,visibleByDefault:o=!1,delayTime:m=D,...v}){const E=f.useRef(null),[p,w]=f.useState(!1),x=_(E,{once:!0,...l}),j=f.useCallback(()=>{const A=setTimeout(()=>{f.startTransition(()=>{w(!0),s?.()})},m);return()=>clearTimeout(A)},[m,s]),b={...M,...u},F=o||x,L=!o&&!p&&!e,h={overlay:()=>n?.overlay&&I.jsx(k,{className:g.overlay,...n.overlay}),placeholder:()=>L&&I.jsx(O,{className:g.placeholder,...n?.placeholder}),image:()=>I.jsx(N,{src:r,alt:a,onLoad:j,className:g.img,...n?.img})};return I.jsxs(V,{ref:T([E,d]),effect:o||b.disabled?void 0:b,className:R([g.root,i],{[g.state.loaded]:!o&&p}),sx:[{"--aspect-ratio":c,...!!c&&{width:1}},...Array.isArray(t)?t:[t]],...v,children:[h.overlay(),h.placeholder(),F&&h.image()]})}export{q as I};
