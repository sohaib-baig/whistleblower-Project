import{w as A,bI as ae,a4 as R,j as e,B as C,bO as W,bP as O,bQ as re,a7 as _,I as x,bJ as oe,bK as le,M as L,y as $,a6 as ne,c as f,r as m,bR as ie,a0 as S,aa as de,p as T,J as ce,U as he,K as ue,ah as me,ab as xe,X as k,Y as G,Z as I,bx as ve}from"./index-BJkBHIXD.js";import{a as be,b as pe,S as J}from"./severity-create-edit-form-D3OiKgZ-.js";import{a as M,d as z,u as ye}from"./severity-Bb8Qe9go.js";import{C as K}from"./confirm-dialog-D488U7AY.js";import{u as ge,g as je,e as fe,T as Ce}from"./table-no-data-BKo9R2Zy.js";import{T as Se}from"./table-empty-rows-BDBaI17h.js";import{T as Te}from"./table-head-custom-C2dATJUG.js";import{T as Re}from"./table-selected-action-uAaUSqFj.js";import{T as De}from"./table-pagination-custom-Dom7EZhX.js";import{T as Fe,a as j,b as Pe,c as we}from"./TableHead-D9jAElFw.js";import{C as ke}from"./FormControlLabel-Do9AncA_.js";import{S as H}from"./Stack-DSqJGNfN.js";import{C as N}from"./Chip-Cd7PxQUv.js";import{C as Ie}from"./Card-CU8jzKuK.js";function Ae({row:r,selected:d,editHref:a,onSelectRow:s,onDeleteRow:c,onEdit:n}){const{t:o}=A("navbar"),l=ae(),u=R(),p=()=>e.jsx(oe,{open:l.open,anchorEl:l.anchorEl,onClose:l.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(le,{children:[e.jsx("li",{children:e.jsxs(L,{onClick:()=>{l.onClose(),n&&n(r.id)},component:n?"div":$,href:n?void 0:a,children:[e.jsx(x,{icon:"solar:pen-bold"}),o("dashboard.severity.menu.edit")]})}),e.jsx(ne,{sx:{borderStyle:"dashed"}}),e.jsxs(L,{onClick:()=>{u.onTrue(),l.onClose()},sx:{color:"error.main"},children:[e.jsx(x,{icon:"solar:trash-bin-trash-bold"}),o("dashboard.severity.menu.delete")]})]})}),D=()=>e.jsx(K,{open:u.value,onClose:u.onFalse,title:o("dashboard.severity.confirmDialog.delete"),content:o("dashboard.severity.confirmDialog.deleteConfirm"),action:e.jsx(f,{variant:"contained",color:"error",onClick:c,children:o("dashboard.severity.confirmDialog.delete")})});return e.jsxs(e.Fragment,{children:[e.jsxs(Fe,{hover:!0,selected:d,children:[e.jsx(j,{padding:"checkbox",children:e.jsx(ke,{checked:d,onClick:s,slotProps:{input:{id:`${r.id}-checkbox`,"aria-label":`${r.id} checkbox`}}})}),e.jsx(j,{children:e.jsx(C,{sx:{display:"flex",alignItems:"center"},children:e.jsx(W,{primary:r.name,secondary:r.id,slotProps:{primary:{noWrap:!0,sx:{typography:"body2"}},secondary:{sx:{mt:.5,typography:"caption"}}}})})}),e.jsx(j,{children:e.jsx(O,{variant:"soft",color:r.status==="active"&&"success"||r.status==="inactive"&&"error"||"default",children:r.status==="active"?o("dashboard.severity.status.active"):r.status==="inactive"?o("dashboard.severity.status.inactive"):r.status})}),e.jsx(j,{children:e.jsx(W,{primary:re(r.createdAt),slotProps:{primary:{noWrap:!0,sx:{typography:"body2"}}}})}),e.jsx(j,{align:"right",sx:{px:1},children:e.jsx(_,{color:l.open?"inherit":"default",onClick:l.onOpen,children:e.jsx(x,{icon:"eva:more-vertical-fill"})})})]}),p(),D()]})}function Ee({filters:r,onFilters:d,onResetFilters:a,results:s,sx:c}){const n=()=>{d("status",{...r,status:"all"})},o=()=>{d("name",{...r,name:""})};return e.jsxs(H,{spacing:1.5,sx:{...c},children:[e.jsxs(C,{sx:{typography:"body2"},children:[e.jsx("strong",{children:s}),e.jsx(C,{component:"span",sx:{color:"text.secondary",ml:.25},children:"results found"})]}),e.jsxs(H,{flexWrap:"wrap",direction:"row",spacing:1,children:[!!r.name&&e.jsx(N,{size:"small",label:"Name",onDelete:o,deleteIcon:e.jsx(x,{icon:"eva:minus-circle-fill"})}),r.status&&r.status!=="all"&&e.jsx(N,{size:"small",label:"Status",onDelete:n,deleteIcon:e.jsx(x,{icon:"eva:minus-circle-fill"})}),e.jsx(f,{color:"error",size:"small",onClick:a,startIcon:e.jsx(x,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})]})}function Qe({showBreadcrumbs:r=!0,showActionButton:d=!0}){const{t:a}=A("navbar"),s=ge(),c=[{id:"name",label:a("dashboard.severity.tableHeaders.severityName"),width:250},{id:"status",label:a("dashboard.severity.tableHeaders.status"),width:100},{id:"createdAt",label:a("dashboard.severity.tableHeaders.createdAt"),width:180},{id:"",width:88}],n=R(),o=R(),l=R(),[u,p]=m.useState(null),D=ie({name:"",status:"all"}),{state:h,setState:y}=D,{severities:F,pagination:E,refetch:b}=M({search:h.name,status:h.status,per_page:s.rowsPerPage,page:s.page+1,sort:s.orderBy||"created_at",order:s.order}),[U,V]=m.useState([]),[P,Y]=m.useState({all:0,active:0,inactive:0}),{severities:g}=M({per_page:1e3});m.useEffect(()=>{if(g){const t=g.filter(w=>w.status==="active").length,i=g.filter(w=>w.status==="inactive").length;Y({all:g.length,active:t,inactive:i})}},[g]),m.useEffect(()=>{F&&V(F)},[F]);const v=We({inputData:U,comparator:je(s.order,s.orderBy),filters:h}),B=!!h.name||h.status!=="all"&&!!h.status,Q=!v.length&&B||!v.length,X=m.useCallback(async t=>{try{await z(t),S.success(a("dashboard.severity.toast.deletedSuccessfully")),b()}catch(i){console.error("Failed to delete severity:",i),S.error(a("dashboard.severity.toast.deleteFailed"))}},[b,a]),Z=m.useCallback(async()=>{try{await Promise.all(s.selected.map(t=>z(t))),S.success(a("dashboard.severity.toast.deletedMultipleSuccessfully")),s.onSelectAllRows(!1,[]),b()}catch(t){console.error("Failed to delete severities:",t),S.error(a("dashboard.severity.toast.deleteMultipleFailed"))}},[s,b,a]),q=m.useCallback((t,i)=>{s.onResetPage(),y({status:i})},[y,s]),ee=m.useCallback(t=>{p(t),l.onTrue()},[l]),se=()=>e.jsx(K,{open:n.value,onClose:n.onFalse,title:a("dashboard.severity.confirmDialog.delete"),content:e.jsx(e.Fragment,{children:a("dashboard.severity.confirmDialog.deleteMultipleConfirm",{count:s.selected.length})}),action:e.jsx(f,{variant:"contained",color:"error",onClick:()=>{Z(),n.onFalse()},children:a("dashboard.severity.confirmDialog.delete")})}),te=[{value:"all",label:a("dashboard.severity.tabs.all"),color:"default",count:P.all},{value:"active",label:a("dashboard.severity.tabs.active"),color:"success",count:P.active},{value:"inactive",label:a("dashboard.severity.tabs.inactive"),color:"error",count:P.inactive}];return e.jsxs(e.Fragment,{children:[r?e.jsx(de,{heading:a("dashboard.severity.list"),links:[{name:"Dashboard",href:T.dashboard.root},{name:a("dashboard.severity.heading"),href:T.dashboard.severity.root},{name:a("dashboard.severity.list")}],action:d?e.jsx(f,{component:$,href:T.dashboard.severity.new,variant:"contained",startIcon:e.jsx(x,{icon:"mingcute:add-line"}),children:a("dashboard.severity.addSeverity")}):void 0,sx:{mb:{xs:3,md:5}}}):d&&e.jsx(C,{sx:{display:"flex",justifyContent:"flex-end",mb:{xs:3,md:5}},children:e.jsx(f,{onClick:o.onTrue,variant:"contained",startIcon:e.jsx(x,{icon:"mingcute:add-line"}),children:a("dashboard.severity.addSeverity")})}),e.jsxs(Ie,{children:[e.jsx(ce,{value:h.status,onChange:q,sx:[t=>({px:{md:2.5},boxShadow:`inset 0 -2px 0 0 ${he(t.vars.palette.grey["500Channel"],.08)}`})],children:te.map(t=>e.jsx(ue,{value:t.value,label:t.label,iconPosition:"end",icon:e.jsx(O,{variant:(t.value==="all"||t.value===h.status)&&"filled"||"soft",color:t.color,children:t.count})},t.value))}),e.jsx(be,{filters:h,onFilters:(t,i)=>y({[t]:i}),statusOptions:pe.map(t=>t.label)}),B&&e.jsx(Ee,{filters:h,onFilters:(t,i)=>y({[t]:i}),onResetFilters:()=>y({name:"",status:"all"}),results:v.length,sx:{p:2.5,pt:0}}),e.jsxs(C,{sx:{position:"relative"},children:[s.selected.length>0&&e.jsx(Re,{dense:s.dense,numSelected:s.selected.length,rowCount:v.length,onSelectAllRows:t=>s.onSelectAllRows(t,v.map(i=>i.id)),action:e.jsx(me,{title:a("dashboard.severity.tooltip.delete"),children:e.jsx(_,{color:"primary",onClick:n.onTrue,children:e.jsx(x,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(xe,{children:e.jsxs(Pe,{size:s.dense?"small":"medium",sx:{minWidth:800},children:[e.jsx(Te,{order:s.order,orderBy:s.orderBy,headCells:c,rowCount:v.length,numSelected:s.selected.length,onSort:s.onSort,onSelectAllRows:t=>s.onSelectAllRows(t,v.map(i=>i.id))}),e.jsxs(we,{children:[v.map(t=>e.jsx(Ae,{row:t,selected:s.selected.includes(t.id),onSelectRow:()=>s.onSelectRow(t.id),onDeleteRow:()=>X(t.id),editHref:T.dashboard.severity.edit(t.id),onEdit:ee},t.id)),e.jsx(Se,{height:s.dense?56:76,emptyRows:fe(s.page,s.rowsPerPage,E.total)}),e.jsx(Ce,{notFound:Q})]})]})})]}),e.jsx(De,{page:s.page,dense:s.dense,count:E.total,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]}),se(),e.jsxs(k,{fullWidth:!0,maxWidth:"sm",open:o.value,onClose:o.onFalse,children:[e.jsx(G,{children:a("dashboard.severity.createNewSeverity")}),e.jsx(I,{children:e.jsx(J,{onClose:o.onFalse,onSuccess:()=>{o.onFalse(),b()}})})]}),u&&e.jsx(Be,{open:l.value,severityId:u,onClose:()=>{l.onFalse(),p(null)},onSuccess:()=>{l.onFalse(),p(null),b()}})]})}function Be({open:r,severityId:d,onClose:a,onSuccess:s}){const{t:c}=A("navbar"),{severity:n,loading:o}=ye(d);return o?e.jsx(k,{fullWidth:!0,maxWidth:"sm",open:r,onClose:a,children:e.jsx(I,{children:e.jsx(ve,{})})}):e.jsxs(k,{fullWidth:!0,maxWidth:"sm",open:r,onClose:a,children:[e.jsx(G,{children:c("dashboard.severity.editSeverity")}),e.jsx(I,{children:n&&e.jsx(J,{currentSeverity:n,onClose:a,onSuccess:s})})]})}function We({inputData:r,comparator:d,filters:a}){const{name:s,status:c}=a,n=r.map((o,l)=>[o,l]);return n.sort((o,l)=>{const u=d(o[0],l[0]);return u!==0?u:o[1]-l[1]}),r=n.map(o=>o[0]),s&&typeof s=="string"&&(r=r.filter(o=>o.name?.toLowerCase().indexOf(s.toLowerCase())!==-1)),c!=="all"&&(r=r.filter(o=>o.status===c)),r}export{Qe as S};
