import{w as F,bI as K,a4 as A,j as e,ah as B,T as U,bP as E,bO as Q,bQ as V,a7 as I,I as m,bJ as Y,bK as q,M as S,y as L,a6 as X,c as f,B as T,bR as Z,r as g,a0 as y,aa as ee,p as j,J as ae,U as te,K as se,ab as oe,W as re}from"./index-BJkBHIXD.js";import{b as w,d as R,e as le,C as ne}from"./category-table-toolbar-ja--RLBF.js";import{C as M}from"./confirm-dialog-D488U7AY.js";import{u as ie,g as ce,e as de,T as he}from"./table-no-data-BKo9R2Zy.js";import{T as me}from"./table-empty-rows-BDBaI17h.js";import{T as ue}from"./table-head-custom-C2dATJUG.js";import{T as ge}from"./table-selected-action-uAaUSqFj.js";import{T as xe}from"./table-pagination-custom-Dom7EZhX.js";import{T as be,a as p,b as pe,c as ye}from"./TableHead-D9jAElFw.js";import{C as je}from"./FormControlLabel-Do9AncA_.js";import{S as k}from"./Stack-DSqJGNfN.js";import{C as D}from"./Chip-Cd7PxQUv.js";import{C as fe}from"./Card-CU8jzKuK.js";import"./text-transform-DM798QSo.js";import"./styles-B-zEs6qR.js";import"./TextField-BfOXJaKd.js";import"./Select-CM-FquqI.js";import"./InputAdornment-Cyf39fZQ.js";import"./empty-content-Cck_Y1yy.js";import"./LastPage-CrCg5Ljk.js";import"./format-number-BErDzwe7.js";function Ce({row:a,selected:t,editHref:i,onSelectRow:c,onDeleteRow:d}){const{t:r}=F("navbar"),o=K(),n=A(),u=()=>e.jsx(Y,{open:o.open,anchorEl:o.anchorEl,onClose:o.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(q,{children:[e.jsx("li",{children:e.jsxs(S,{component:L,href:i,onClick:o.onClose,children:[e.jsx(m,{icon:"solar:pen-bold"}),r("dashboard.category.edit")]})}),e.jsx(X,{sx:{borderStyle:"dashed"}}),e.jsxs(S,{onClick:()=>{n.onTrue(),o.onClose()},sx:{color:"error.main"},children:[e.jsx(m,{icon:"solar:trash-bin-trash-bold"}),r("dashboard.category.delete")]})]})}),x=()=>e.jsx(M,{open:n.value,onClose:n.onFalse,title:r("dashboard.category.deleteConfirmTitle"),content:r("dashboard.category.deleteConfirmMessage"),action:e.jsx(f,{variant:"contained",color:"error",onClick:d,children:r("dashboard.category.delete")})});return e.jsxs(e.Fragment,{children:[e.jsxs(be,{hover:!0,selected:t,children:[e.jsx(p,{padding:"checkbox",children:e.jsx(je,{checked:t,onClick:c,slotProps:{input:{id:`${a.id}-checkbox`,"aria-label":`${a.id} checkbox`}}})}),e.jsx(p,{sx:{maxWidth:250},children:e.jsx(B,{title:a.name||"",arrow:!0,children:e.jsx(U,{variant:"body2",noWrap:!0,sx:{maxWidth:230},children:a.name})})}),e.jsx(p,{children:e.jsx(E,{variant:"soft",color:a.status==="active"&&"success"||a.status==="inactive"&&"error"||"default",children:a.status})}),e.jsx(p,{children:e.jsx(Q,{primary:V(a.createdAt),slotProps:{primary:{noWrap:!0,sx:{typography:"body2"}}}})}),e.jsx(p,{align:"right",sx:{px:1},children:e.jsx(I,{color:o.open?"inherit":"default",onClick:o.onOpen,children:e.jsx(m,{icon:"eva:more-vertical-fill"})})})]}),u(),x()]})}function ve({filters:a,onFilters:t,onResetFilters:i,results:c,sx:d}){const r=()=>{t("status",{...a,status:"all"})},o=()=>{t("name",{...a,name:""})};return e.jsxs(k,{spacing:1.5,sx:{...d},children:[e.jsxs(T,{sx:{typography:"body2"},children:[e.jsx("strong",{children:c}),e.jsx(T,{component:"span",sx:{color:"text.secondary",ml:.25},children:"results found"})]}),e.jsxs(k,{flexWrap:"wrap",direction:"row",spacing:1,children:[!!a.name&&e.jsx(D,{size:"small",label:"Name",onDelete:o,deleteIcon:e.jsx(m,{icon:"eva:minus-circle-fill"})}),a.status&&a.status!=="all"&&e.jsx(D,{size:"small",label:"Status",onDelete:r,deleteIcon:e.jsx(m,{icon:"eva:minus-circle-fill"})}),e.jsx(f,{color:"error",size:"small",onClick:i,startIcon:e.jsx(m,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})]})}function Te(){const{t:a}=F("navbar"),t=ie(),i=A(),c=[{id:"name",label:a("dashboard.category.tableHeaders.categoryName"),width:250},{id:"status",label:a("dashboard.category.tableHeaders.status"),width:100},{id:"createdAt",label:a("dashboard.category.tableHeaders.createdAt"),width:180},{id:"",width:88}],d=Z({name:"",status:"all"}),{state:r,setState:o}=d,{categories:n,pagination:u,refetch:x}=w({search:r.name,status:r.status,per_page:t.rowsPerPage,page:t.page+1,sort:t.orderBy||"created_at",order:t.order}),[O,W]=g.useState([]),[C,z]=g.useState({all:0,active:0,inactive:0}),{categories:b}=w({per_page:1e3});g.useEffect(()=>{if(b){const s=b.filter(v=>v.status==="active").length,l=b.filter(v=>v.status==="inactive").length;z({all:b.length,active:s,inactive:l})}},[b]),g.useEffect(()=>{n&&W(n)},[n]);const h=Pe({inputData:O,comparator:ce(t.order,t.orderBy),filters:r}),P=!!r.name||r.status!=="all"&&!!r.status,H=!h.length&&P||!h.length,_=g.useCallback(async s=>{try{await R(s),y.success(a("dashboard.category.categoryDeleted")),x()}catch(l){console.error("Failed to delete category:",l),y.error(a("dashboard.category.failedToDelete"))}},[x,a]),N=g.useCallback(async()=>{try{await Promise.all(t.selected.map(s=>R(s))),y.success(a("dashboard.category.categoriesDeleted")),t.onSelectAllRows(!1,[]),x()}catch(s){console.error("Failed to delete categories:",s),y.error(a("dashboard.category.failedToDeletePlural"))}},[t,x,a]),$=g.useCallback((s,l)=>{t.onResetPage(),o({status:l})},[o,t]),G=()=>e.jsx(M,{open:i.value,onClose:i.onFalse,title:a("dashboard.category.deleteConfirmTitle"),content:e.jsxs(e.Fragment,{children:[a("dashboard.category.deleteConfirmMessagePlural")," ",e.jsxs("strong",{children:[" ",t.selected.length," "]})," ",a("dashboard.category.items"),"?"]}),action:e.jsx(f,{variant:"contained",color:"error",onClick:()=>{N(),i.onFalse()},children:a("dashboard.category.delete")})}),J=[{value:"all",label:a("dashboard.category.all"),color:"default",count:C.all},{value:"active",label:a("dashboard.category.active"),color:"success",count:C.active},{value:"inactive",label:a("dashboard.category.inactive"),color:"error",count:C.inactive}];return e.jsxs(e.Fragment,{children:[e.jsx(ee,{heading:a("dashboard.category.list"),links:[{name:"Dashboard",href:j.dashboard.root},{name:a("dashboard.category.heading"),href:j.dashboard.category.root},{name:a("dashboard.category.list")}],action:e.jsx(f,{component:L,href:j.dashboard.category.new,variant:"contained",startIcon:e.jsx(m,{icon:"mingcute:add-line"}),children:a("dashboard.category.addCategory")}),sx:{mb:{xs:3,md:5}}}),e.jsxs(fe,{children:[e.jsx(ae,{value:r.status,onChange:$,sx:[s=>({px:{md:2.5},boxShadow:`inset 0 -2px 0 0 ${te(s.vars.palette.grey["500Channel"],.08)}`})],children:J.map(s=>e.jsx(se,{value:s.value,label:s.label,iconPosition:"end",icon:e.jsx(E,{variant:(s.value==="all"||s.value===r.status)&&"filled"||"soft",color:s.color,children:s.count})},s.value))}),e.jsx(le,{filters:r,onFilters:(s,l)=>o({[s]:l}),statusOptions:ne.map(s=>s.label)}),P&&e.jsx(ve,{filters:r,onFilters:(s,l)=>o({[s]:l}),onResetFilters:()=>o({name:"",status:"all"}),results:h.length,sx:{p:2.5,pt:0}}),e.jsxs(T,{sx:{position:"relative"},children:[t.selected.length>0&&e.jsx(ge,{dense:t.dense,numSelected:t.selected.length,rowCount:h.length,onSelectAllRows:s=>t.onSelectAllRows(s,h.map(l=>l.id)),action:e.jsx(B,{title:a("dashboard.category.delete"),children:e.jsx(I,{color:"primary",onClick:i.onTrue,children:e.jsx(m,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(oe,{children:e.jsxs(pe,{size:t.dense?"small":"medium",sx:{minWidth:800},children:[e.jsx(ue,{order:t.order,orderBy:t.orderBy,headCells:c,rowCount:h.length,numSelected:t.selected.length,onSort:t.onSort,onSelectAllRows:s=>t.onSelectAllRows(s,h.map(l=>l.id))}),e.jsxs(ye,{children:[h.map(s=>e.jsx(Ce,{row:s,selected:t.selected.includes(s.id),onSelectRow:()=>t.onSelectRow(s.id),onDeleteRow:()=>_(s.id),editHref:j.dashboard.category.edit(s.id)},s.id)),e.jsx(me,{height:t.dense?56:76,emptyRows:de(t.page,t.rowsPerPage,u.total)}),e.jsx(he,{notFound:H})]})]})})]}),e.jsx(xe,{page:t.page,dense:t.dense,count:u.total,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,onChangeDense:t.onChangeDense,onRowsPerPageChange:t.onChangeRowsPerPage})]}),G()]})}function Pe({inputData:a,comparator:t,filters:i}){const{name:c,status:d}=i,r=a.map((o,n)=>[o,n]);return r.sort((o,n)=>{const u=t(o[0],n[0]);return u!==0?u:o[1]-n[1]}),a=r.map(o=>o[0]),c&&typeof c=="string"&&(a=a.filter(o=>o.name?.toLowerCase().indexOf(c.toLowerCase())!==-1)),d!=="all"&&(a=a.filter(o=>o.status===d)),a}function Se(){return e.jsx(re,{children:e.jsx(Te,{})})}function Ue(){return e.jsx(Se,{})}export{Ue as default};
