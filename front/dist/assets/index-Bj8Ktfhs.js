import{w as M,bI as $,a4 as I,r as u,j as e,L as Z,y as L,B as j,bP as B,bQ as q,a7 as N,I as d,bJ as G,bK as U,M as f,c as k,X as ee,Y as ae,Z as te,_ as se,b as le,a0 as D,bR as oe,R as H,aa as ne,p as F,J as re,U as ie,K as ce,ah as de,ab as me,C as he,x as pe}from"./index-BJkBHIXD.js";import{b as ue,d as W,e as _}from"./email-template-DfGgWqTD.js";import{C as K}from"./confirm-dialog-D488U7AY.js";import{u as xe,g as be,e as ge,T as je}from"./table-no-data-BKo9R2Zy.js";import{T as Te}from"./table-empty-rows-BDBaI17h.js";import{T as fe}from"./table-head-custom-C2dATJUG.js";import{T as ve}from"./table-selected-action-uAaUSqFj.js";import{T as Ce}from"./table-pagination-custom-Dom7EZhX.js";import{T as Se,a as S,b as De,c as ye}from"./TableHead-D9jAElFw.js";import{C as ke}from"./FormControlLabel-Do9AncA_.js";import{S as O}from"./Stack-DSqJGNfN.js";import{F as J,S as Q}from"./Select-CM-FquqI.js";import{I as V,T as we}from"./TextField-BfOXJaKd.js";import{I as Ae}from"./InputAdornment-Cyf39fZQ.js";import{C as z}from"./Chip-Cd7PxQUv.js";import{C as Fe}from"./Card-CU8jzKuK.js";import"./text-transform-DM798QSo.js";import"./styles-B-zEs6qR.js";import"./empty-content-Cck_Y1yy.js";import"./LastPage-CrCg5Ljk.js";import"./format-number-BErDzwe7.js";const Pe=["sv","no","da","fi","de","fr"];function Ee({row:a,selected:t,editHref:m,onSelectRow:c,onDeleteRow:o,onConvertSuccess:r}){const{t:s}=M("navbar"),n=$(),h=I(),x=I(),[i,w]=u.useState(""),[T,y]=u.useState(!1),P=a.language==="en"||!a.language,v=async()=>{if(!i){D.error(s("dashboard.emailTemplate.convertDialog.errorInvalidLanguage"));return}y(!0);try{await ue(a.id,i),D.success(s("dashboard.emailTemplate.convertDialog.success")),x.onFalse(),w(""),r&&r()}catch(p){const C=p?.response?.data?.message||p?.message||s("dashboard.emailTemplate.convertDialog.error");D.error(C)}finally{y(!1)}},b=()=>e.jsx(G,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(U,{children:[P&&e.jsxs(f,{onClick:()=>{x.onTrue(),n.onClose()},children:[e.jsx(d,{icon:"solar:global-bold"}),s("dashboard.emailTemplate.menuActions.convertToLanguage")]}),e.jsx("li",{children:e.jsxs(f,{component:L,href:m,onClick:()=>n.onClose(),children:[e.jsx(d,{icon:"solar:pen-bold"}),s("dashboard.emailTemplate.menuActions.edit")]})}),e.jsxs(f,{onClick:()=>{h.onTrue(),n.onClose()},sx:{color:"error.main"},children:[e.jsx(d,{icon:"solar:trash-bin-trash-bold"}),s("dashboard.emailTemplate.menuActions.delete")]})]})}),A=()=>e.jsx(K,{open:h.value,onClose:h.onFalse,title:s("dashboard.emailTemplate.confirmDialog.deleteTitle"),content:s("dashboard.emailTemplate.confirmDialog.deleteSingleContent"),action:e.jsx(k,{variant:"contained",color:"error",onClick:o,children:s("dashboard.emailTemplate.menuActions.delete")})}),E=()=>e.jsxs(ee,{open:x.value,onClose:T?void 0:x.onFalse,maxWidth:"sm",fullWidth:!0,children:[e.jsx(ae,{children:s("dashboard.emailTemplate.convertDialog.title")}),e.jsx(te,{children:e.jsxs(j,{sx:{py:2},children:[e.jsx(j,{sx:{mb:3,color:"text.secondary"},children:s("dashboard.emailTemplate.convertDialog.description")}),e.jsxs(J,{fullWidth:!0,children:[e.jsx(V,{children:s("dashboard.emailTemplate.convertDialog.selectLanguage")}),e.jsx(Q,{value:i,onChange:p=>w(p.target.value),label:s("dashboard.emailTemplate.convertDialog.selectLanguage"),disabled:T,children:Pe.map(p=>e.jsx(f,{value:p,children:s(`dashboard.emailTemplate.languageOptions.${p}`)},p))})]})]})}),e.jsxs(se,{children:[e.jsx(k,{onClick:x.onFalse,disabled:T,children:s("dashboard.emailTemplate.convertDialog.cancel")}),e.jsx(k,{variant:"contained",onClick:v,disabled:!i||T,startIcon:T?e.jsx(le,{size:16}):e.jsx(d,{icon:"solar:global-bold"}),children:s(T?"dashboard.emailTemplate.convertDialog.converting":"dashboard.emailTemplate.convertDialog.convert")})]})]});return e.jsxs(e.Fragment,{children:[e.jsxs(Se,{hover:!0,selected:t,"aria-checked":t,tabIndex:-1,children:[e.jsx(S,{padding:"checkbox",children:e.jsx(ke,{checked:t,onClick:c,slotProps:{input:{id:`${a.id}-checkbox`,"aria-label":`${a.id} checkbox`}}})}),e.jsx(S,{children:e.jsxs(O,{sx:{typography:"body2",flex:"1 1 auto",alignItems:"flex-start"},children:[e.jsx(Z,{component:L,href:m,color:"inherit",sx:{cursor:"pointer"},children:a.name}),e.jsx(j,{component:"span",sx:{color:"text.disabled"},children:a.subject})]})}),e.jsx(S,{sx:{whiteSpace:"nowrap"},children:a.subject}),e.jsx(S,{children:e.jsx(B,{variant:"soft",color:"info",children:(()=>{if(!a.language)return"EN";const p=`dashboard.emailTemplate.languageOptions.${a.language}`,C=s(p);return C&&C!==p?C:a.language.toUpperCase()})()})}),e.jsx(S,{children:e.jsx(B,{variant:"soft",color:a.status==="active"&&"success"||a.status==="inactive"&&"warning"||"default",children:a.status==="active"?s("dashboard.emailTemplate.statusOptions.active"):a.status==="inactive"?s("dashboard.emailTemplate.statusOptions.inactive"):a.status})}),e.jsx(S,{sx:{whiteSpace:"nowrap"},children:q(a.createdAt)}),e.jsx(S,{children:e.jsx(j,{sx:{display:"flex",alignItems:"center"},children:e.jsx(N,{color:n.open?"inherit":"default",onClick:n.onOpen,children:e.jsx(d,{icon:"eva:more-vertical-fill"})})})})]}),b(),A(),E()]})}function Re({filters:a,statusOptions:t,onResetPage:m}){const{t:c}=M("navbar"),o=$(),{state:r,setState:s}=a,n=u.useCallback(i=>{m(),s({name:i.target.value})},[m,s]),h=u.useCallback(i=>{m(),s({status:i.target.value})},[m,s]),x=()=>e.jsx(G,{open:o.open,anchorEl:o.anchorEl,onClose:o.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(U,{children:[e.jsxs(f,{onClick:()=>o.onClose(),children:[e.jsx(d,{icon:"solar:printer-minimalistic-bold"}),c("dashboard.emailTemplate.menuActions.print")]}),e.jsxs(f,{onClick:()=>o.onClose(),children:[e.jsx(d,{icon:"solar:import-bold"}),c("dashboard.emailTemplate.menuActions.import")]}),e.jsxs(f,{onClick:()=>o.onClose(),children:[e.jsx(d,{icon:"solar:export-bold"}),c("dashboard.emailTemplate.menuActions.export")]})]})});return e.jsxs(e.Fragment,{children:[e.jsxs(j,{sx:{p:2.5,gap:2,display:"flex",pr:{xs:2.5,md:1},flexDirection:{xs:"column",md:"row"},alignItems:{xs:"flex-end",md:"center"}},children:[e.jsxs(J,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(V,{htmlFor:"filter-status-select",children:c("dashboard.emailTemplate.toolbar.status")}),e.jsx(Q,{label:c("dashboard.emailTemplate.toolbar.status"),value:r.status,onChange:h,inputProps:{id:"filter-status-select"},MenuProps:{slotProps:{paper:{sx:{maxHeight:240}}}},children:t.map(i=>e.jsx(f,{value:i.value,children:i.label},i.value))})]}),e.jsxs(j,{sx:{gap:2,width:1,flexGrow:1,display:"flex",alignItems:"center"},children:[e.jsx(we,{fullWidth:!0,value:r.name,onChange:n,placeholder:c("dashboard.emailTemplate.toolbar.searchPlaceholder"),slotProps:{input:{startAdornment:e.jsx(Ae,{position:"start",children:e.jsx(d,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}}),e.jsx(N,{onClick:o.onOpen,children:e.jsx(d,{icon:"eva:more-vertical-fill"})})]})]}),x()]})}function Ie({filters:a,onResetPage:t,totalResults:m,sx:c}){const{state:o,setState:r}=a,s=u.useCallback(()=>{r({status:""}),t()},[r,t]),n=u.useCallback(()=>{r({name:""}),t()},[r,t]),h=u.useCallback(()=>{r({name:"",status:""}),t()},[r,t]);return!!o.name||!!o.status?e.jsxs(O,{spacing:1.5,sx:{p:2.5,pt:0},children:[e.jsxs(j,{sx:{typography:"body2"},children:[e.jsx("strong",{children:m}),e.jsx(j,{component:"span",sx:{color:"text.secondary",ml:.25},children:"results found"})]}),e.jsxs(O,{flexWrap:"wrap",direction:"row",spacing:1,children:[!!o.name&&e.jsx(z,{size:"small",label:"Name",onDelete:n,deleteIcon:e.jsx(d,{icon:"solar:close-circle-bold"})}),!!o.status&&e.jsx(z,{size:"small",label:"Status",onDelete:s,deleteIcon:e.jsx(d,{icon:"solar:close-circle-bold"})}),e.jsx(k,{color:"error",onClick:h,startIcon:e.jsx(d,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})]}):null}function Le(){const{t:a}=M("navbar"),t=xe(),m=[{value:"all",label:a("dashboard.emailTemplate.tabs.all")},{value:"active",label:a("dashboard.emailTemplate.tabs.active")},{value:"inactive",label:a("dashboard.emailTemplate.tabs.inactive")}],c=[{id:"name",label:a("dashboard.emailTemplate.tableHead.templateName"),width:220},{id:"subject",label:a("dashboard.emailTemplate.tableHead.subject"),width:200},{id:"language",label:a("dashboard.emailTemplate.tableHead.language"),width:120},{id:"status",label:a("dashboard.emailTemplate.tableHead.status"),width:100},{id:"createdAt",label:a("dashboard.emailTemplate.tableHead.createdAt"),width:180},{id:"",width:88}],o=I(),r=oe({name:"",status:"all"}),{state:s,setState:n}=r,{templates:h,pagination:x,refetch:i}=W({search:s.name,status:s.status,per_page:t.rowsPerPage,page:t.page+1,sort:t.orderBy||"created_at",order:t.order}),[w,T]=u.useState([]),[y,P]=u.useState({all:0,active:0,inactive:0}),{templates:v}=W({per_page:1e3});H.useEffect(()=>{if(v){const l=v.filter(R=>R.status==="active").length,g=v.filter(R=>R.status==="inactive").length;P({all:v.length,active:l,inactive:g})}},[v]),H.useEffect(()=>{h&&T(h)},[h]);const b=Be({inputData:w,comparator:be(t.order,t.orderBy),filters:s}),A=!!s.name||s.status!=="all"&&!!s.status,E=!b.length&&A||!b.length,p=u.useCallback(async l=>{try{await _(l),D.success(a("dashboard.emailTemplate.toast.deleteSuccess")),i()}catch(g){console.error("Failed to delete email template:",g),D.error(a("dashboard.emailTemplate.toast.deleteError"))}},[i,a]),C=u.useCallback(async()=>{try{await Promise.all(t.selected.map(l=>_(l))),D.success(a("dashboard.emailTemplate.toast.deleteMultipleSuccess")),i(),t.onSelectAllRows(!1,[])}catch(l){console.error("Failed to delete email templates:",l),D.error(a("dashboard.emailTemplate.toast.deleteMultipleError"))}},[t,i,a]),X=u.useCallback((l,g)=>{t.onResetPage(),n({status:g})},[n,t]),Y=()=>e.jsx(K,{open:o.value,onClose:o.onFalse,title:a("dashboard.emailTemplate.confirmDialog.deleteTitle"),content:e.jsx(e.Fragment,{children:a("dashboard.emailTemplate.confirmDialog.deleteContent",{count:t.selected.length})}),action:e.jsx(k,{variant:"contained",color:"error",onClick:()=>{C(),o.onFalse()},children:a("dashboard.emailTemplate.menuActions.delete")})});return e.jsxs(e.Fragment,{children:[e.jsx(ne,{heading:a("dashboard.emailTemplate.heading"),links:[{name:"Dashboard",href:F.dashboard.overview.analytics},{name:a("dashboard.emailTemplate.heading"),href:F.dashboard.emailTemplate.root},{name:a("dashboard.emailTemplate.list")}],action:e.jsx(k,{component:L,href:F.dashboard.emailTemplate.create,variant:"contained",startIcon:e.jsx(d,{icon:"mingcute:add-line"}),children:a("dashboard.emailTemplate.addEmailTemplate")}),sx:{mb:{xs:3,md:5}}}),e.jsxs(Fe,{children:[e.jsx(re,{value:s.status||"all",onChange:X,sx:[l=>({px:{md:2.5},boxShadow:`inset 0 -2px 0 0 ${ie(l.vars.palette.grey["500Channel"],.08)}`})],children:m.map(l=>e.jsx(ce,{iconPosition:"end",value:l.value,label:l.label,icon:e.jsx(B,{variant:(l.value==="all"||l.value===s.status)&&"filled"||"soft",color:l.value==="active"&&"success"||l.value==="inactive"&&"warning"||"default",children:l.value==="all"?y.all:l.value==="active"?y.active:y.inactive})},l.value))}),e.jsx(Re,{filters:r,onResetPage:t.onResetPage,statusOptions:m}),A&&e.jsx(Ie,{filters:r,totalResults:b.length,onResetPage:t.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(j,{sx:{position:"relative"},children:[e.jsx(ve,{dense:t.dense,numSelected:t.selected.length,rowCount:b.length,onSelectAllRows:l=>t.onSelectAllRows(l,b.map(g=>g.id)),action:e.jsx(de,{title:a("dashboard.emailTemplate.menuActions.delete"),children:e.jsx(N,{color:"primary",onClick:o.onTrue,children:e.jsx(d,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(me,{children:e.jsxs(De,{size:t.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(fe,{order:t.order,orderBy:t.orderBy,headCells:c,rowCount:b.length,numSelected:t.selected.length,onSort:t.onSort,onSelectAllRows:l=>t.onSelectAllRows(l,b.map(g=>g.id))}),e.jsxs(ye,{children:[b.map(l=>e.jsx(Ee,{row:l,selected:t.selected.includes(l.id),onSelectRow:()=>t.onSelectRow(l.id),onDeleteRow:()=>p(l.id),editHref:F.dashboard.emailTemplate.edit(l.id),onConvertSuccess:i},l.id)),e.jsx(Te,{height:t.dense?56:76,emptyRows:ge(t.page,t.rowsPerPage,x.total)}),e.jsx(je,{notFound:E})]})]})})]}),e.jsx(Ce,{page:t.page,dense:t.dense,count:x.total,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,onChangeDense:t.onChangeDense,onRowsPerPageChange:t.onChangeRowsPerPage})]}),Y()]})}function Be({inputData:a,comparator:t,filters:m}){const{name:c,status:o}=m,r=a.map((s,n)=>[s,n]);return r.sort((s,n)=>{const h=t(s[0],n[0]);return h!==0?h:s[1]-n[1]}),a=r.map(s=>s[0]),c&&typeof c=="string"&&(a=a.filter(s=>s.name?.toLowerCase().includes(c.toLowerCase()))),o&&o!=="all"&&(a=a.filter(s=>s.status===o)),a}function Oe(){return e.jsx(he,{maxWidth:"xl",children:e.jsx(Le,{})})}const Me={title:`Email Templates | Dashboard - ${pe.appName}`};function oa(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:Me.title}),e.jsx(Oe,{})]})}export{oa as default};
