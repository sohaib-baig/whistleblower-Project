import{w as y,u as H,r as d,a0 as f,p as j,j as e,B as v,M as s,T as L,c as E,C as V,a9 as P,x as k}from"./index-BJkBHIXD.js";import"./empty-content-Cck_Y1yy.js";import{a as D}from"./index.esm-DG78EUPk.js";import{a as M}from"./zod-DbnPk1Kl.js";import{u as z,a as A,f as U}from"./email-template-DfGgWqTD.js";import{F as r}from"./fields-wQ2IQIfM.js";import{s as W}from"./schema-utils-C_-d4BNQ.js";import{F as $}from"./form-provider-BYLnCB41.js";import{G as S}from"./Grid-D_Et280v.js";import{C as J}from"./Card-CU8jzKuK.js";import{S as p}from"./Stack-DSqJGNfN.js";import{o as K,s as o}from"./schemas-BaSQ7w8v.js";import"./text-transform-DM798QSo.js";import"./styles-B-zEs6qR.js";import"./TextField-BfOXJaKd.js";import"./Select-CM-FquqI.js";import"./index-BdCJuPE0.js";import"./rhf-phone-input-DvY4aKGv.js";import"./index-CDpvdXdB.js";import"./search-not-found-BYtFGFNz.js";import"./InputAdornment-Cyf39fZQ.js";import"./rhf-text-field-D45rQogC.js";import"./RadioGroup-eX8WPtuC.js";import"./FormControlLabel-Do9AncA_.js";import"./Autocomplete-vOabT0lM.js";import"./Chip-Cd7PxQUv.js";import"./rhf-select-BCHEEYe2.js";import"./upload-default-BMHhCMpu.js";import"./tslib.es6-CTYbIaVE.js";import"./DatePicker-D3hVcc_W.js";import"./format-number-BErDzwe7.js";function Q({id:i}){const{t:a}=y("navbar"),u=H(),w=K({name:o().min(1,{message:a("dashboard.emailTemplate.validation.templateNameRequired")}),subject:o().min(1,{message:a("dashboard.emailTemplate.validation.subjectRequired")}),content:W.editor().min(1,{message:a("dashboard.emailTemplate.validation.contentRequired")}),placeholder:o().optional(),language:o().min(1,{message:a("dashboard.emailTemplate.validation.languageRequired")}),status:o().min(1,{message:a("dashboard.emailTemplate.validation.statusRequired")})}),{template:m,loading:O}=z(i),F={name:"",subject:"",content:"",placeholder:"",language:"en",status:"active"},h=D({mode:"onSubmit",resolver:M(w),defaultValues:F,values:m||void 0}),{handleSubmit:I,watch:g,setValue:l,formState:{isSubmitting:C}}=h,n=g("language"),c=g("name"),[R,x]=d.useState(!1),[q,b]=d.useState(null),[B,G]=d.useState(!0);d.useEffect(()=>{if(B&&m){b(m.language||"en"),G(!1);return}(async()=>{if(!(!c||!m||n===q)){x(!0);try{const t=await U(c,n);t?(l("subject",t.subject||""),l("content",t.content||""),l("status",t.status||"active"),l("placeholder",t.placeholder||"")):(l("subject",""),l("content",""),l("status","active")),b(n)}catch(t){console.error("Failed to load template for language:",t)}finally{x(!1)}}})()},[n,c]);const N=I(async T=>{try{await A(i,T),f.success(a("dashboard.emailTemplate.toast.updateSuccess")),u.push(j.dashboard.emailTemplate.root)}catch(t){console.error(t),f.error(a("dashboard.emailTemplate.toast.updateError"))}});return O?e.jsx(v,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400},children:a("dashboard.emailTemplate.form.loading")}):e.jsx($,{methods:h,onSubmit:N,children:e.jsx(S,{container:!0,spacing:3,children:e.jsx(S,{size:{xs:12},children:e.jsxs(J,{sx:{p:3},children:[e.jsxs(v,{sx:{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[e.jsx(r.Text,{name:"name",label:a("dashboard.emailTemplate.form.templateName")}),e.jsx(r.Text,{name:"subject",label:a("dashboard.emailTemplate.form.subject")}),e.jsxs(r.Select,{name:"language",label:a("dashboard.emailTemplate.form.language"),disabled:R,children:[e.jsx(s,{value:"en",children:a("dashboard.emailTemplate.languageOptions.en")}),e.jsx(s,{value:"sv",children:a("dashboard.emailTemplate.languageOptions.sv")}),e.jsx(s,{value:"no",children:a("dashboard.emailTemplate.languageOptions.no")}),e.jsx(s,{value:"da",children:a("dashboard.emailTemplate.languageOptions.da")}),e.jsx(s,{value:"fi",children:a("dashboard.emailTemplate.languageOptions.fi")}),e.jsx(s,{value:"fr",children:a("dashboard.emailTemplate.languageOptions.fr")}),e.jsx(s,{value:"de",children:a("dashboard.emailTemplate.languageOptions.de")})]}),e.jsxs(r.Select,{name:"status",label:a("dashboard.emailTemplate.form.status"),placeholder:a("dashboard.emailTemplate.form.selectStatus"),children:[e.jsx(s,{value:"active",children:a("dashboard.emailTemplate.statusOptions.active")}),e.jsx(s,{value:"inactive",children:a("dashboard.emailTemplate.statusOptions.inactive")})]})]}),e.jsxs(p,{spacing:3,sx:{mt:3},children:[e.jsxs(p,{spacing:1.5,children:[e.jsx(L,{variant:"subtitle2",children:a("dashboard.emailTemplate.form.content")}),e.jsx(r.Editor,{name:"content",fullItem:!0,sx:{maxHeight:400,"& .ql-editor":{minHeight:200}}})]}),e.jsx(r.Text,{name:"placeholder",label:a("dashboard.emailTemplate.form.placeholderVariables"),placeholder:a("dashboard.emailTemplate.form.placeholderExample"),multiline:!0,rows:3,helperText:a("dashboard.emailTemplate.form.placeholderHelperText")})]}),e.jsx(p,{sx:{mt:3,alignItems:"flex-end"},children:e.jsxs(p,{direction:"row",spacing:2,children:[e.jsx(E,{variant:"outlined",onClick:()=>u.push(j.dashboard.emailTemplate.root),children:a("dashboard.emailTemplate.form.cancel")}),e.jsx(E,{type:"submit",variant:"contained",loading:C,children:a("dashboard.emailTemplate.form.save")})]})})]})})})})}function X({id:i}){const{t:a}=y("navbar");return e.jsxs(V,{maxWidth:"xl",children:[e.jsx(L,{variant:"h4",sx:{mb:5},children:a("dashboard.emailTemplate.editEmailTemplate")}),e.jsx(Q,{id:i})]})}const Y={title:`Edit Email Template | Dashboard - ${k.appName}`};function Ce(){const{id:i}=P();return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:Y.title}),e.jsx(X,{id:i||""})]})}export{Ce as default};
