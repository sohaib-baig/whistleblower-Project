import{r as n,i as v,s as M,e as i,w as y,j as u,I as b,bz as E,M as C}from"./index-BJkBHIXD.js";import{S as T}from"./Stack-DSqJGNfN.js";import{T as x}from"./TextField-BfOXJaKd.js";import{I as S}from"./InputAdornment-Cyf39fZQ.js";async function P(a){const e=new URLSearchParams;a?.search&&e.append("search",a.search),a?.status&&a.status!=="all"&&e.append("status",a.status),a?.per_page&&e.append("per_page",a.per_page.toString()),a?.page&&e.append("page",a.page.toString()),a?.sort&&e.append("sort",a.sort),a?.order&&e.append("order",a.order);const r=`${i.caseManagers.list}?${e.toString()}`;return{data:(await M.get(r)).data}}async function w(a){const e=typeof i.caseManagers.details=="function"?i.caseManagers.details(a):i.caseManagers.details;return(await M.get(e)).data}async function F(a){return await v(),(await M.post(i.caseManagers.create,a)).data}async function L(a,e){const r=typeof i.caseManagers.update=="function"?i.caseManagers.update(a):i.caseManagers.update;return await v(),(await M.put(r,e)).data}async function O(a){const e=typeof i.caseManagers.delete=="function"?i.caseManagers.delete(a):i.caseManagers.delete;await v(),await M.delete(e)}function R(a){const[e,r]=n.useState([]),[o,l]=n.useState(!0),[g,d]=n.useState(null),[m,t]=n.useState({currentPage:1,perPage:15,total:0,lastPage:1}),p=JSON.stringify(a),f=n.useCallback(async()=>{try{l(!0),d(null);const s=p?JSON.parse(p):void 0,h=await P(s),_=h.data.data.map(c=>({id:c.id,name:c.name,email:c.email,phone:c.phone||"",status:c.is_active===1?"active":c.is_active===2?"pending":(c.is_active===0,"banned"),isVerified:!!c.email_verified_at,isActive:c.is_active===1,createdAt:c.created_at,updatedAt:c.updated_at}));r(_),t({currentPage:h.data.current_page,perPage:h.data.per_page,total:h.data.total,lastPage:h.data.last_page})}catch(s){console.error("Failed to fetch case managers:",s),d(s instanceof Error?s.message:"Failed to fetch case managers"),r([])}finally{l(!1)}},[p]);return n.useEffect(()=>{f()},[f]),{caseManagers:e,loading:o,error:g,pagination:m,refetch:f}}function W(a){const[e,r]=n.useState(null),[o,l]=n.useState(!0),[g,d]=n.useState(null);return n.useEffect(()=>{async function m(){try{l(!0),d(null);const t=await w(a),p={id:t.id,name:t.name,email:t.email,phone:t.phone||"",status:t.is_active===1?"active":t.is_active===2?"pending":(t.is_active===0,"banned"),isVerified:!!t.email_verified_at,isActive:t.is_active===1,createdAt:t.created_at,updatedAt:t.updated_at};r(p)}catch(t){console.error("Failed to fetch case manager:",t),d(t instanceof Error?t.message:"Failed to fetch case manager"),r(null)}finally{l(!1)}}a&&m()},[a]),{caseManager:e,loading:o,error:g}}function A({filters:a,onFilters:e,onResetFilter:r}){const{t:o}=y("navbar"),[l,g]=n.useState(a.name),[d,m]=n.useState(a.email);n.useEffect(()=>{g(a.name),m(a.email)},[a.name,a.email]),n.useEffect(()=>{const s=setTimeout(()=>{l!==a.name&&e("name",l)},500);return()=>clearTimeout(s)},[l,a.name,e]),n.useEffect(()=>{const s=setTimeout(()=>{d!==a.email&&e("email",d)},500);return()=>clearTimeout(s)},[d,a.email,e]);const t=n.useCallback(s=>{g(s.target.value)},[]),p=n.useCallback(s=>{m(s.target.value)},[]),f=n.useCallback(s=>{e("status",s.target.value)},[e]);return u.jsxs(T,{spacing:2,direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[u.jsx(x,{fullWidth:!0,value:l,onChange:t,placeholder:o("dashboard.caseManager.searchCaseManager"),InputProps:{startAdornment:u.jsx(S,{position:"start",children:u.jsx(b,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}),u.jsx(x,{fullWidth:!0,value:d,onChange:p,placeholder:o("dashboard.caseManager.searchEmail"),InputProps:{startAdornment:u.jsx(S,{position:"start",children:u.jsx(b,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}),u.jsxs(x,{fullWidth:!0,select:!0,label:o("dashboard.caseManager.status"),value:a.status,onChange:f,SelectProps:{MenuProps:{PaperProps:{sx:{maxHeight:240}}}},sx:{maxWidth:{xs:1,sm:180},textTransform:"capitalize"},children:[u.jsx(C,{value:"all",children:o("dashboard.caseManager.all")}),E.map(s=>u.jsx(C,{value:s.value,sx:{mx:1,borderRadius:.75,typography:"body2",textTransform:"capitalize"},children:o(`dashboard.caseManager.statusOptions.${s.value}`)},s.value))]})]})}const z=n.memo(A);export{z as C,W as a,R as b,F as c,O as d,L as u};
