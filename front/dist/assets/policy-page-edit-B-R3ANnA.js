import{w as C,u as L,a4 as g,a0 as b,p as r,r as V,j as e,B as o,T as s,a7 as y,I as f,a5 as A,a6 as G,c as h,V as M,W as j,aa as N,x as R}from"./index-BJkBHIXD.js";import{E as U}from"./empty-content-Cck_Y1yy.js";import{a as _}from"./index.esm-DG78EUPk.js";import{a as q}from"./zod-DbnPk1Kl.js";import{u as O,a as $}from"./policy-page-DcpKg7Jw.js";import{F as P}from"./fields-wQ2IQIfM.js";import{s as J}from"./schema-utils-C_-d4BNQ.js";import{F as K}from"./form-provider-BYLnCB41.js";import{S as l}from"./Stack-DSqJGNfN.js";import{C as v}from"./Card-CU8jzKuK.js";import{C as Q}from"./CardHeader-BmHD0Q2N.js";import{o as X,s as Y}from"./schemas-BaSQ7w8v.js";import"./text-transform-DM798QSo.js";import"./TextField-BfOXJaKd.js";import"./Select-CM-FquqI.js";import"./index-BdCJuPE0.js";import"./rhf-phone-input-DvY4aKGv.js";import"./index-CDpvdXdB.js";import"./search-not-found-BYtFGFNz.js";import"./InputAdornment-Cyf39fZQ.js";import"./rhf-text-field-D45rQogC.js";import"./RadioGroup-eX8WPtuC.js";import"./FormControlLabel-Do9AncA_.js";import"./Autocomplete-vOabT0lM.js";import"./Chip-Cd7PxQUv.js";import"./rhf-select-BCHEEYe2.js";import"./styles-B-zEs6qR.js";import"./format-number-BErDzwe7.js";import"./upload-default-BMHhCMpu.js";import"./tslib.es6-CTYbIaVE.js";import"./DatePicker-D3hVcc_W.js";const Z=t=>X({title:Y().optional(),content:J.editor().min(20,{message:t("dashboard.policyPage.errors.contentMinLength")})});function ee(){const{t}=C("navbar"),a=L(),{data:c,isLoading:w}=O(),E=$(),I=Z(t),d=g(),m=g(!0),F={title:"",content:""},x=_({mode:"all",resolver:q(I),defaultValues:F,values:c?{title:c.title,content:c.content}:void 0}),{watch:S,handleSubmit:H,formState:{isSubmitting:k,isValid:u}}=x,p=S(),B=H(async n=>{try{const i={...n,title:n.title?.trim()||""};await E.mutateAsync(i),b.success(t("dashboard.policyPage.toast.updatedSuccessfully")),a.push(r.dashboard.policyPage.root)}catch(i){console.error(i),b.error(t("dashboard.policyPage.toast.updateFailed"))}}),D=V.useCallback(()=>{a.push(r.dashboard.policyPage.root)},[a]),T=(n,i)=>e.jsx(y,{onClick:i,children:e.jsx(f,{icon:n?"eva:arrow-ios-downward-fill":"eva:arrow-ios-forward-fill"})}),z=()=>e.jsxs(v,{children:[e.jsx(Q,{title:t("dashboard.policyPage.form.title"),subheader:t("dashboard.policyPage.form.subheader"),action:T(m.value,m.onToggle),sx:{mb:3}}),e.jsxs(A,{in:m.value,children:[e.jsx(G,{}),e.jsxs(l,{spacing:3,sx:{p:3},children:[e.jsx(P.Text,{name:"title",label:t("dashboard.policyPage.form.titleLabel")}),e.jsxs(l,{spacing:1.5,children:[e.jsx(s,{variant:"subtitle2",children:t("dashboard.policyPage.form.content")}),e.jsx(P.Editor,{name:"content",fullItem:!0,sx:{maxHeight:600,"& .ql-editor":{minHeight:400}}}),e.jsx(s,{variant:"caption",color:"text.secondary",sx:{mt:1},children:t("dashboard.policyPage.form.tip")})]})]})]})]}),W=()=>e.jsxs(o,{sx:{display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"flex-end",gap:2,p:2.5},children:[e.jsx(h,{color:"inherit",variant:"outlined",size:"medium",onClick:d.onTrue,disabled:!u,children:t("dashboard.policyPage.actions.preview")}),e.jsx(h,{color:"inherit",variant:"outlined",size:"medium",onClick:D,children:t("dashboard.policyPage.actions.cancel")}),e.jsx(h,{type:"submit",variant:"contained",size:"medium",loading:k,disabled:!u,children:t("dashboard.policyPage.actions.saveChanges")})]});return w?e.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400},children:e.jsx(s,{children:t("dashboard.policyPage.loading")})}):e.jsxs(K,{methods:x,onSubmit:B,children:[e.jsxs(l,{spacing:5,sx:{mx:"auto",maxWidth:{xs:720,xl:880}},children:[z(),W()]}),d.value&&e.jsx(o,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,bgcolor:"rgba(0, 0, 0, 0.5)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",p:2},children:e.jsxs(v,{sx:{maxWidth:"90vw",maxHeight:"90vh",overflow:"auto",position:"relative"},children:[e.jsx(o,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:e.jsxs(l,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(s,{variant:"h6",children:t("dashboard.policyPage.actions.preview")}),e.jsx(y,{onClick:d.onFalse,children:e.jsx(f,{icon:"solar:close-circle-bold"})})]})}),e.jsxs(o,{sx:{p:3},children:[p.title?.trim()&&e.jsx(s,{variant:"h4",sx:{mb:2},children:p.title}),e.jsx(o,{sx:{"& h1, & h2, & h3, & h4, & h5, & h6":{color:"text.primary",fontWeight:600,mb:2,mt:3,"&:first-of-type":{mt:0}},"& p":{color:"text.secondary",lineHeight:1.7,mb:2},"& ul, & ol":{pl:3,mb:2,"& li":{color:"text.secondary",lineHeight:1.7,mb:.5}}},dangerouslySetInnerHTML:{__html:p.content}})]})]})})]})}function te(){const{t}=C("navbar"),{user:a}=M();return a?.role!=="company"?e.jsx(j,{children:e.jsx(U,{filled:!0,title:t("dashboard.policyPage.unauthorized.title"),description:t("dashboard.policyPage.unauthorized.description")})}):e.jsxs(j,{children:[e.jsx(N,{heading:t("dashboard.policyPage.editPolicyPage"),backHref:r.dashboard.policyPage.root,links:[{name:"Dashboard",href:r.dashboard.root},{name:t("dashboard.policyPage.heading"),href:r.dashboard.policyPage.root},{name:t("dashboard.policyPage.edit")}],sx:{mb:{xs:3,md:5}}}),e.jsx(ee,{})]})}const oe={title:`Edit Policy Page | Dashboard - ${R.appName}`};function ze(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:oe.title}),e.jsx(te,{})]})}export{ze as default};
