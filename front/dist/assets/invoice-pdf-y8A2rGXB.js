import{r as S,j as e,X as U,B as x,T as j,I as D,ab as M,bb as G,bP as J,db as X,a4 as q,a7 as R,a6 as B,dg as L,c as A,M as E,w as K,cE as k,b6 as Y,u as Z,dh as ee,p as te,cD as se,bQ as $}from"./index-BJkBHIXD.js";import{u as P,c as le,a as ne}from"./index.esm-DG78EUPk.js";import{a as ie}from"./zod-DbnPk1Kl.js";import"./text-transform-DM798QSo.js";import"./styles-B-zEs6qR.js";import{s as W}from"./schema-utils-C_-d4BNQ.js";import{F as re}from"./form-provider-BYLnCB41.js";import{S as oe}from"./search-not-found-BYtFGFNz.js";import{T as ae}from"./TextField-BfOXJaKd.js";import{I as V}from"./InputAdornment-Cyf39fZQ.js";import{S as w}from"./Stack-DSqJGNfN.js";import{F as f}from"./fields-wQ2IQIfM.js";import{b as z,c as ce}from"./format-number-BErDzwe7.js";import{C as de}from"./Card-CU8jzKuK.js";import{o as N,k as O,s as C,n as v,a as xe}from"./schemas-BaSQ7w8v.js";import{P as he,D as me,a as ue,S as pe,V as r,I as ye,T as n,F as je}from"./react-pdf.browser-BH-ePMdR.js";function be(l,s){let i=0;for(let a=0;a<l.length;a++)i+=s(l[a]);return i}function H({sx:l,open:s,list:i,action:a,onClose:h,selected:m,onSelect:d,title:u="Address book",...c}){const[o,p]=S.useState(""),t=fe({inputData:i,query:o}),I=!t.length&&!!o,g=S.useCallback(y=>{p(y.target.value)},[]),T=S.useCallback(y=>{d(y),p(""),h()},[h,d]),_=()=>e.jsx(M,{sx:{p:.5,maxHeight:480},children:e.jsx(x,{sx:{gap:.5,display:"flex",flexDirection:"column"},children:t.map(y=>e.jsxs(G,{onClick:()=>T(y),sx:{py:1,px:1.5,gap:.5,width:1,borderRadius:1,display:"flex",flexDirection:"column",alignItems:"flex-start",...m(`${y.id}`)&&{bgcolor:"action.selected"}},children:[e.jsxs(x,{sx:{gap:1,display:"flex",alignItems:"center"},children:[e.jsx(j,{variant:"subtitle2",children:y.name}),y.primary&&e.jsx(J,{color:"info",children:"Default"})]}),y.company&&e.jsx(x,{sx:{color:"primary.main",typography:"caption"},children:y.company}),e.jsx(j,{variant:"body2",sx:{color:"text.secondary"},children:y.fullAddress}),y.phoneNumber&&e.jsx(j,{variant:"body2",sx:{color:"text.secondary"},children:y.phoneNumber})]},y.id))})});return e.jsxs(U,{fullWidth:!0,maxWidth:"xs",open:s,onClose:h,sx:l,...c,children:[e.jsxs(x,{sx:{py:3,pl:3,pr:1.5,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(j,{variant:"h6",children:[" ",u," "]}),a&&a]}),e.jsx(x,{sx:{px:2,pb:2},children:e.jsx(ae,{fullWidth:!0,value:o,onChange:g,placeholder:"Search...",slotProps:{input:{startAdornment:e.jsx(V,{position:"start",children:e.jsx(D,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}})}),I?e.jsx(oe,{query:o,sx:{px:3,pt:5,pb:10}}):_()]})}function fe({inputData:l,query:s}){return s?l.filter(({name:i,company:a,fullAddress:h,phoneNumber:m})=>[i,a,h,m].some(d=>d?.toLowerCase().includes(s.toLowerCase()))):l}function ge(){const{watch:l,setValue:s,formState:{errors:i}}=P(),a=X(o=>o.breakpoints.up("md")),h=l(),m=q(),d=q(),{invoiceFrom:u,invoiceTo:c}=h;return e.jsxs(e.Fragment,{children:[e.jsxs(w,{divider:e.jsx(B,{flexItem:!0,orientation:a?"vertical":"horizontal",sx:{borderStyle:"dashed"}}),sx:{p:3,gap:{xs:3,md:5},flexDirection:{xs:"column",md:"row"}},children:[e.jsxs(w,{sx:{width:1},children:[e.jsxs(x,{sx:{mb:1,display:"flex",alignItems:"center"},children:[e.jsx(j,{variant:"h6",sx:{color:"text.disabled",flexGrow:1},children:"From:"}),e.jsx(R,{onClick:d.onTrue,children:e.jsx(D,{icon:"solar:pen-bold"})})]}),e.jsxs(w,{spacing:1,children:[e.jsx(j,{variant:"subtitle2",children:u?.name}),e.jsx(j,{variant:"body2",children:u?.fullAddress}),e.jsxs(j,{variant:"body2",children:[" ",u?.phoneNumber]})]})]}),e.jsxs(w,{sx:{width:1},children:[e.jsxs(x,{sx:{mb:1,display:"flex",alignItems:"center"},children:[e.jsx(j,{variant:"h6",sx:{color:"text.disabled",flexGrow:1},children:"To:"}),e.jsx(R,{onClick:m.onTrue,children:e.jsx(D,{icon:c?"solar:pen-bold":"mingcute:add-line"})})]}),c?e.jsxs(w,{spacing:1,children:[e.jsx(j,{variant:"subtitle2",children:c?.name}),e.jsx(j,{variant:"body2",children:c?.fullAddress}),e.jsxs(j,{variant:"body2",children:[" ",c?.phoneNumber]})]}):e.jsx(j,{typography:"caption",sx:{color:"error.main"},children:i.invoiceTo?.message})]})]}),e.jsx(H,{title:"Customers",open:d.value,onClose:d.onFalse,selected:o=>u?.id===o,onSelect:o=>o&&s("invoiceFrom",o),list:L,action:e.jsx(A,{size:"small",startIcon:e.jsx(D,{icon:"mingcute:add-line"}),sx:{alignSelf:"flex-end"},children:"Add"})}),e.jsx(H,{title:"Customers",open:m.value,onClose:m.onFalse,selected:o=>c?.id===o,onSelect:o=>o&&s("invoiceTo",o),list:L,action:e.jsx(A,{size:"small",startIcon:e.jsx(D,{icon:"mingcute:add-line"}),sx:{alignSelf:"flex-end"},children:"Add"})})]})}const ve=["paid","pending"];function Se(){const{watch:l}=P(),s=l();return e.jsxs(x,{sx:{p:3,gap:2,display:"flex",bgcolor:"background.neutral",flexDirection:{xs:"column",sm:"row"}},children:[e.jsx(f.Text,{disabled:!0,name:"invoiceNumber",label:"Invoice number",value:s.invoiceNumber}),e.jsx(f.Select,{fullWidth:!0,name:"status",label:"Status",slotProps:{inputLabel:{shrink:!0}},children:ve.map(i=>e.jsx(E,{value:i,sx:{textTransform:"capitalize"},children:i},i))}),e.jsx(f.DatePicker,{name:"createDate",label:"Date create"}),e.jsx(f.DatePicker,{name:"dueDate",label:"Due date"})]})}function Ie({sx:l,taxes:s,subtotal:i,totalAmount:a,...h}){const{t:m}=K("navbar"),d={display:"flex",alignItems:"center"},u={color:"text.secondary"},c={width:160};return e.jsxs(x,{sx:[{mt:3,gap:2,display:"flex",textAlign:"right",typography:"body2",alignItems:"flex-end",flexDirection:"column"},...Array.isArray(l)?l:[l]],...h,children:[e.jsxs(x,{sx:d,children:[e.jsx(x,{component:"span",sx:u,children:"Subtotal"}),e.jsx(x,{component:"span",sx:[c,{fontWeight:"fontWeightSemiBold"}],children:z(i)||"-"})]}),e.jsxs(x,{sx:d,children:[e.jsx(x,{component:"span",sx:u,children:m("dashboard.invoice.details.vat")}),e.jsx(x,{component:"span",sx:c,children:s&&i&&i>0?ce(s/i*100):"-"})]}),e.jsxs(x,{sx:[d,{typography:"subtitle1"}],children:[e.jsx(x,{component:"span",children:"Total"}),e.jsx(x,{component:"span",sx:c,children:z(a)||"-"})]})]})}const F={title:"",description:"",service:k[0].name,price:k[0].price,quantity:1,total:0},De=l=>({title:`items[${l}].title`,description:`items[${l}].description`,service:`items[${l}].service`,quantity:`items[${l}].quantity`,price:`items[${l}].price`,total:`items[${l}].total`});function Te(){const{control:l,setValue:s,getValues:i}=P(),{fields:a,append:h,remove:m}=le({control:l,name:"items"}),d=i("items"),u=i("taxes"),c=i("discount"),o=i("shipping"),p=be(d,g=>g.quantity*g.price),I=p+p*(u/100)-c-o;return S.useEffect(()=>{s("subtotal",p),s("totalAmount",I)},[s,p,I]),e.jsxs(x,{sx:{p:3},children:[e.jsx(j,{variant:"h6",sx:{color:"text.disabled",mb:3},children:"Details:"}),e.jsx(w,{divider:e.jsx(B,{flexItem:!0,sx:{borderStyle:"dashed"}}),spacing:3,children:a.map((g,T)=>e.jsx(we,{fieldNames:De(T),onRemoveItem:()=>m(T)},g.id))}),e.jsx(B,{sx:{my:3,borderStyle:"dashed"}}),e.jsxs(x,{sx:{gap:3,display:"flex",flexDirection:{xs:"column",md:"row"},alignItems:{xs:"flex-end",md:"center"}},children:[e.jsx(A,{size:"small",color:"primary",startIcon:e.jsx(D,{icon:"mingcute:add-line"}),onClick:()=>h(F),sx:{flexShrink:0},children:"Add item"}),e.jsxs(x,{sx:{gap:2,width:1,display:"flex",justifyContent:"flex-end",flexDirection:{xs:"column",md:"row"}},children:[e.jsx(f.Text,{size:"small",label:"Shipping($)",name:"shipping",type:"number",sx:{maxWidth:{md:120}},slotProps:{inputLabel:{shrink:!0}}}),e.jsx(f.Text,{size:"small",label:"Discount($)",name:"discount",type:"number",sx:{maxWidth:{md:120}},slotProps:{inputLabel:{shrink:!0}}}),e.jsx(f.Text,{size:"small",label:"Taxes(%)",name:"taxes",type:"number",sx:{maxWidth:{md:120}},slotProps:{inputLabel:{shrink:!0}}})]})]}),e.jsx(Ie,{taxes:u,subtotal:p,totalAmount:I})]})}function we({onRemoveItem:l,fieldNames:s}){const{getValues:i,setValue:a}=P(),h=i(s.price),m=i(s.quantity);S.useEffect(()=>{const c=Number((h*m).toFixed(2));a(s.total,c)},[s.total,h,m,a]);const d=S.useCallback(c=>{const o=k.find(p=>p.name===c);a(s.price,o?.price)},[s.price,a]),u=S.useCallback(()=>{a(s.quantity,F.quantity),a(s.price,F.price),a(s.total,F.total)},[s.price,s.quantity,s.total,a]);return e.jsxs(x,{sx:{gap:1.5,display:"flex",alignItems:"flex-end",flexDirection:"column"},children:[e.jsxs(x,{sx:{gap:2,width:1,display:"flex",flexDirection:{xs:"column",md:"row"}},children:[e.jsx(f.Text,{size:"small",name:s.title,label:"Title",slotProps:{inputLabel:{shrink:!0}}}),e.jsx(f.Text,{multiline:!0,maxRows:3,size:"small",name:s.description,label:"Description",slotProps:{inputLabel:{shrink:!0}}}),e.jsxs(f.Select,{size:"small",name:s.service,label:"Service",slotProps:{inputLabel:{shrink:!0}},sx:{maxWidth:{md:160}},children:[e.jsx(E,{value:"",onClick:u,sx:{fontStyle:"italic",color:"text.secondary"},children:"None"}),e.jsx(B,{sx:{borderStyle:"dashed"}}),k.map(c=>e.jsx(E,{value:c.name,onClick:()=>d(c.name),children:c.name},c.id))]}),e.jsx(f.Text,{size:"small",type:"number",name:s.quantity,label:"Quantity",placeholder:"0",slotProps:{inputLabel:{shrink:!0}},sx:{maxWidth:{md:96}}}),e.jsx(f.Text,{size:"small",type:"number",name:s.price,label:"Price",placeholder:"0.00",slotProps:{input:{startAdornment:e.jsx(V,{position:"start",children:e.jsx(x,{sx:{typography:"subtitle2",color:"text.disabled"},children:"$"})})}},sx:{maxWidth:{md:96}}}),e.jsx(f.Text,{disabled:!0,size:"small",name:s.total,type:"number",label:"Total",placeholder:"0.00",slotProps:{input:{startAdornment:e.jsx(V,{position:"start",children:e.jsx(x,{sx:{typography:"subtitle2",color:"text.disabled"},children:"$"})})}},sx:{maxWidth:{md:128},[`& .${Y.input}`]:{textAlign:{md:"right"}}}})]}),e.jsx(A,{size:"small",color:"error",startIcon:e.jsx(D,{icon:"solar:trash-bin-trash-bold"}),onClick:l,children:"Remove"})]})}const Ce=N({invoiceTo:W.nullableInput(O(),{error:"Invoice to is required!"}),createDate:W.date({error:{required:"Create date is required!"}}),dueDate:W.date({error:{required:"Due date is required!"}}),items:xe(N({title:C().min(1,{error:"Title is required!"}),service:C().min(1,{error:"Service is required!"}),quantity:v().int().positive().min(1,{error:"Quantity must be more than 0"}),price:v(),total:v(),description:C()})),taxes:v(),status:C(),discount:v(),shipping:v(),subtotal:v(),totalAmount:v(),invoiceNumber:C(),invoiceFrom:O().nullable()}).refine(l=>!se(l.createDate,l.dueDate),{error:"Due date cannot be earlier than create date!",path:["dueDate"]});function Ue({currentInvoice:l}){const s=Z(),i=q(),a={invoiceNumber:"INV-1990",createDate:ee(),dueDate:null,taxes:0,shipping:0,status:"pending",discount:0,invoiceFrom:L[0],invoiceTo:null,subtotal:0,totalAmount:0,items:[F]},h=ne({mode:"all",resolver:ie(Ce),defaultValues:a,values:l}),{reset:m,handleSubmit:d,formState:{isSubmitting:u}}=h,c=d(async o=>{i.onTrue();try{await new Promise(p=>setTimeout(p,500)),m(),i.onFalse(),s.push(te.dashboard.invoice.root),console.info("DATA",JSON.stringify(o,null,2))}catch(p){console.error(p),i.onFalse()}});return e.jsxs(re,{methods:h,children:[e.jsxs(de,{children:[e.jsx(ge,{}),e.jsx(Se,{}),e.jsx(Te,{})]}),e.jsx(x,{sx:{mt:3,gap:2,display:"flex",justifyContent:"flex-end"},children:e.jsxs(A,{size:"large",variant:"contained",loading:i.value&&u,onClick:c,children:[l?"Update":"Create"," & send"]})})]})}function Me({invoice:l,currentStatus:s}){return e.jsx(he,{width:"100%",height:"100%",style:{border:"none"},children:e.jsx(Ae,{invoice:l,currentStatus:s})})}je.register({family:"Roboto",fonts:[{src:"/fonts/Roboto-Regular.ttf"},{src:"/fonts/Roboto-Bold.ttf"}]});const Fe=()=>S.useMemo(()=>pe.create({page:{fontSize:9,lineHeight:1.6,fontFamily:"Roboto",backgroundColor:"#FFFFFF",padding:"40px 24px 120px 24px"},footer:{left:0,right:0,bottom:0,padding:24,margin:"auto",borderTopWidth:1,borderStyle:"solid",position:"absolute",borderColor:"#e9ecef"},container:{flexDirection:"row",justifyContent:"space-between"},mb4:{marginBottom:4},mb8:{marginBottom:8},mb40:{marginBottom:40},h3:{fontSize:16,fontWeight:700,lineHeight:1.2},h4:{fontSize:12,fontWeight:700},text1:{fontSize:10},text2:{fontSize:9},text1Bold:{fontSize:10,fontWeight:700},text2Bold:{fontSize:9,fontWeight:700},table:{display:"flex",width:"100%"},row:{padding:"10px 0 8px 0",flexDirection:"row",borderBottomWidth:1,borderStyle:"solid",borderColor:"#e9ecef"},cell_1:{width:"5%"},cell_2:{width:"50%"},cell_3:{width:"15%",paddingLeft:32},cell_4:{width:"15%",paddingLeft:8},cell_5:{width:"15%"},noBorder:{paddingTop:"10px",paddingBottom:0,borderBottomWidth:0}}),[]);function Ae({invoice:l,currentStatus:s}){const{items:i,taxes:a,dueDate:h,subtotal:m,invoiceTo:d,createDate:u,totalAmount:c,invoiceFrom:o,invoiceNumber:p}=l??{},t=Fe(),I=()=>e.jsxs(r,{style:[t.container,t.mb40],children:[e.jsx(ye,{source:"/logo/logo-single.png",style:{width:48,height:48}}),e.jsxs(r,{style:{alignItems:"flex-end",flexDirection:"column"},children:[e.jsx(n,{style:[t.h3,t.mb8,{textTransform:"capitalize"}],children:s}),e.jsx(n,{style:[t.text2],children:p})]})]}),g=()=>e.jsxs(r,{style:[t.container,t.footer],fixed:!0,children:[e.jsxs(r,{style:{width:"75%"},children:[e.jsx(n,{style:[t.text2Bold,t.mb4],children:"NOTES"}),e.jsx(n,{style:[t.text2],children:"We appreciate your business."})]}),e.jsxs(r,{style:{width:"25%",textAlign:"right"},children:[e.jsx(n,{style:[t.text2Bold,t.mb4],children:"Have a question?"}),e.jsx(n,{style:[t.text2],children:"support@abcapp.com"})]})]}),T=()=>e.jsxs(r,{style:[t.container,t.mb40],children:[e.jsxs(r,{style:{width:"50%"},children:[e.jsx(n,{style:[t.text1Bold,t.mb4],children:"Invoice from"}),o?.company&&e.jsx(n,{style:[t.text2],children:o.company}),o?.companyNumber&&e.jsxs(n,{style:[t.text2],children:["Company Number: ",o.companyNumber]}),e.jsx(n,{style:[t.text2],children:o?.fullAddress}),e.jsx(n,{style:[t.text2],children:o?.phoneNumber})]}),e.jsxs(r,{style:{width:"50%"},children:[e.jsx(n,{style:[t.text1Bold,t.mb4],children:"Invoice to"}),e.jsx(n,{style:[t.text2],children:d?.name}),d?.company&&e.jsx(n,{style:[t.text2],children:d.company}),d?.companyNumber&&e.jsxs(n,{style:[t.text2],children:["Company Number: ",d.companyNumber]}),e.jsx(n,{style:[t.text2],children:d?.fullAddress}),e.jsx(n,{style:[t.text2],children:d?.phoneNumber})]})]}),_=()=>e.jsxs(r,{style:[t.container,t.mb40],children:[e.jsxs(r,{style:{width:"50%"},children:[e.jsx(n,{style:[t.text1Bold,t.mb4],children:"Date create"}),e.jsx(n,{style:[t.text2],children:$(u)})]}),e.jsxs(r,{style:{width:"50%"},children:[e.jsx(n,{style:[t.text1Bold,t.mb4],children:"Due date"}),e.jsx(n,{style:[t.text2],children:$(h)})]})]}),y=()=>e.jsxs(e.Fragment,{children:[e.jsx(n,{style:[t.text1Bold],children:"Invoice details"}),e.jsxs(r,{style:t.table,children:[e.jsx(r,{children:e.jsxs(r,{style:t.row,children:[e.jsx(r,{style:t.cell_1,children:e.jsx(n,{style:[t.text2Bold],children:"#"})}),e.jsx(r,{style:t.cell_2,children:e.jsx(n,{style:[t.text2Bold],children:"Description"})}),e.jsx(r,{style:t.cell_3,children:e.jsx(n,{style:[t.text2Bold],children:"Qty"})}),e.jsx(r,{style:t.cell_4,children:e.jsx(n,{style:[t.text2Bold],children:"Unit price"})}),e.jsx(r,{style:[t.cell_5,{textAlign:"right"}],children:e.jsx(n,{style:[t.text2Bold],children:"Total"})})]})}),e.jsxs(r,{children:[i?.map((b,Q)=>e.jsxs(r,{style:t.row,children:[e.jsx(r,{style:t.cell_1,children:e.jsx(n,{children:Q+1})}),e.jsxs(r,{style:t.cell_2,children:[e.jsx(n,{style:[t.text2Bold],children:b.title}),e.jsx(n,{style:[t.text2],children:b.description})]}),e.jsx(r,{style:t.cell_3,children:e.jsx(n,{style:[t.text2],children:b.quantity})}),e.jsx(r,{style:t.cell_4,children:e.jsx(n,{style:[t.text2],children:b.price})}),e.jsx(r,{style:[t.cell_5,{textAlign:"right"}],children:e.jsx(n,{style:[t.text2],children:z(b.price*b.quantity)})})]},b.id)),[{name:"Subtotal",value:m},{name:"Taxes",value:a},{name:"Total",value:c,styles:t.h4}].map(b=>e.jsxs(r,{style:[t.row,t.noBorder],children:[e.jsx(r,{style:t.cell_1}),e.jsx(r,{style:t.cell_2}),e.jsx(r,{style:t.cell_3}),e.jsx(r,{style:t.cell_4,children:e.jsx(n,{style:[b.styles??t.text2],children:b.name})}),e.jsx(r,{style:[t.cell_5,{textAlign:"right"}],children:e.jsx(n,{style:[b.styles??t.text2],children:z(b.value)})})]},b.name))]})]})]});return e.jsx(me,{children:e.jsxs(ue,{size:"A4",style:t.page,children:[I(),T(),_(),y(),g()]})})}export{Ue as I,Me as a,Ie as b,be as s};
