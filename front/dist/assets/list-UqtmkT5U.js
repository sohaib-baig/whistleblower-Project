import{bI as w,r as d,j as e,a7 as B,I as m,B as u,bO as $,L as k,y,T as C,bt as M,a6 as q,bJ as I,bK as A,M as T,p as j,c as N,u as z,cG as H,b4 as v,cH as G,b as K,bw as L,a0 as V,W as _,aa as D,cU as J}from"./index-BJkBHIXD.js";import{C as U}from"./Card-CU8jzKuK.js";import{C as Q}from"./Chip-Cd7PxQUv.js";import{F as X}from"./FormControlLabel-Do9AncA_.js";import{P as Y,p as Z}from"./Pagination-BT9THikJ.js";import{m as ee,p as se}from"./index-BdvNLWsN.js";import{S as te}from"./search-not-found-BYtFGFNz.js";import{A as oe}from"./Autocomplete-vOabT0lM.js";import{T as ne}from"./TextField-BfOXJaKd.js";import{I as re}from"./InputAdornment-Cyf39fZQ.js";import{S as ae}from"./Stack-DSqJGNfN.js";import{o as g}from"./orderBy-BP_idRMj.js";import"./integration-create-edit-form-Mm3Djaw_.js";import"./Select-CM-FquqI.js";import"./LastPage-CrCg5Ljk.js";import"./index.esm-DG78EUPk.js";import"./zod-DbnPk1Kl.js";import"./schemas-BaSQ7w8v.js";import"./fields-wQ2IQIfM.js";import"./text-transform-DM798QSo.js";import"./index-BdCJuPE0.js";import"./rhf-phone-input-DvY4aKGv.js";import"./index-CDpvdXdB.js";import"./rhf-text-field-D45rQogC.js";import"./RadioGroup-eX8WPtuC.js";import"./rhf-select-BCHEEYe2.js";import"./styles-B-zEs6qR.js";import"./format-number-BErDzwe7.js";import"./upload-default-BMHhCMpu.js";import"./tslib.es6-CTYbIaVE.js";import"./DatePicker-D3hVcc_W.js";import"./form-provider-BYLnCB41.js";import"./CardHeader-BmHD0Q2N.js";function ie({integrationItem:s,editHref:o,detailsHref:r,onDelete:a,sx:h,...i}){const l=w(),[c,p]=d.useState(s.status==="active"),x=t=>{p(t)},f=t=>{switch(t){case"active":return"success";case"inactive":return"default";default:return"default"}},b=t=>{switch(t){case"active":return"eva:checkmark-fill";case"inactive":return"eva:cloud-upload-fill";default:return"eva:cloud-upload-fill"}},n=()=>e.jsx(I,{open:l.open,anchorEl:l.anchorEl,onClose:l.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsx(A,{children:e.jsx("li",{children:e.jsxs(T,{component:y,href:o,onClick:()=>l.onClose(),children:[e.jsx(m,{icon:"solar:pen-bold"}),"Edit"]})})})});return e.jsxs(e.Fragment,{children:[e.jsxs(U,{sx:h,...i,children:[e.jsx(B,{onClick:l.onOpen,sx:{position:"absolute",top:8,right:8},children:e.jsx(m,{icon:"eva:more-vertical-fill"})}),e.jsxs(u,{sx:{p:3,pb:2},children:[e.jsx($,{sx:{mb:1},primary:e.jsx(k,{component:y,href:o,color:"inherit",children:s.name}),secondary:e.jsx(u,{sx:{display:"flex",alignItems:"center",gap:1,mt:.5},children:e.jsx(Q,{size:"small",label:s.status,color:f(s.status),icon:e.jsx(m,{icon:b(s.status),width:16})})}),slotProps:{primary:{sx:{typography:"subtitle1"}},secondary:{sx:{mt:1,typography:"caption",color:"text.disabled"}}}}),e.jsxs(u,{sx:{gap:.5,display:"flex",alignItems:"center",color:"primary.main",typography:"caption"},children:[e.jsx(m,{width:16,icon:"eva:link-2-fill"}),s.endpoint]}),e.jsx(u,{sx:{mt:2},children:e.jsx(X,{control:e.jsx(M,{size:"small",checked:c,onChange:t=>x(t.target.checked),color:"success"}),label:e.jsx(C,{variant:"caption",color:c?"success.main":"text.secondary",children:c?"Connected":"Disconnected"}),sx:{m:0}})})]}),e.jsx(q,{sx:{borderStyle:"dashed"}}),e.jsx(u,{sx:{p:3,rowGap:1.5,display:"grid",gridTemplateColumns:"repeat(2, 1fr)"},children:[{label:`App Key: ${s.appKey.substring(0,8)}...`,icon:e.jsx(m,{width:16,icon:"eva:external-link-fill",sx:{flexShrink:0}})},{label:`Secret: ${s.appSecret.substring(0,8)}...`,icon:e.jsx(m,{width:16,icon:"eva:cloud-upload-fill",sx:{flexShrink:0}})},{label:s.totalRequests?`${s.totalRequests} requests`:"No requests",icon:e.jsx(m,{width:16,icon:"eva:activity-fill",sx:{flexShrink:0}})},{label:s.successRate?`${s.successRate}% success`:"No data",icon:e.jsx(m,{width:16,icon:"eva:trending-up-fill",sx:{flexShrink:0}})}].map(t=>e.jsxs(u,{sx:{gap:.5,minWidth:0,flexShrink:0,display:"flex",alignItems:"center",color:"text.disabled"},children:[t.icon,e.jsx(C,{variant:"caption",noWrap:!0,children:t.label})]},t.label))})]}),n()]})}function le({integrations:s,onDelete:o}){return e.jsxs(e.Fragment,{children:[e.jsx(u,{sx:{gap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"}},children:s.map(r=>e.jsx(ie,{integrationItem:r,editHref:j.dashboard.integration.edit(r.id),detailsHref:j.dashboard.integration.details(r.id),onDelete:()=>o(r.id)},r.id))}),s.length>8&&e.jsx(Y,{count:8,sx:{mt:{xs:8,md:8},[`& .${Z.ul}`]:{justifyContent:"center"}}})]})}function ce({sort:s,onSort:o,sortOptions:r}){const a=w(),h=()=>e.jsx(I,{open:a.open,anchorEl:a.anchorEl,onClose:a.onClose,children:e.jsx(A,{children:r.map(i=>e.jsx(T,{selected:i.value===s,onClick:()=>{a.onClose(),o(i.value)},children:i.label},i.value))})});return e.jsxs(e.Fragment,{children:[e.jsxs(N,{disableRipple:!0,color:"inherit",onClick:a.onOpen,endIcon:e.jsx(m,{icon:a.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill"}),sx:{fontWeight:"fontWeightSemiBold"},children:["Sort by:",e.jsx(u,{component:"span",sx:{ml:.5,fontWeight:"fontWeightBold",textTransform:"capitalize"},children:s})]}),h()]})}function de({redirectPath:s,sx:o}){const r=z(),[a,h]=d.useState(""),[i,l]=d.useState(null),c=H(a),{searchResults:p,searchLoading:x}=pe(c),f=d.useCallback(n=>{l(n),n&&r.push(s(n.id))},[s,r]),b={width:320,[`& .${v.listbox}`]:{[`& .${v.option}`]:{p:0,[`& .${G.root}`]:{px:1,py:.75,width:1}}}};return e.jsx(oe,{autoHighlight:!0,popupIcon:null,loading:x,options:p,value:i,onChange:(n,t)=>f(t),onInputChange:(n,t)=>h(t),getOptionLabel:n=>n.name,noOptionsText:e.jsx(te,{query:c}),isOptionEqualToValue:(n,t)=>n.id===t.id,slotProps:{paper:{sx:b}},sx:[{width:{xs:1,sm:260}},...Array.isArray(o)?o:[o]],renderInput:n=>e.jsx(ne,{...n,placeholder:"Search integrations...",slotProps:{input:{...n.InputProps,startAdornment:e.jsx(re,{position:"start",children:e.jsx(m,{icon:"eva:search-fill",sx:{ml:1,color:"text.disabled"}})}),endAdornment:e.jsxs(e.Fragment,{children:[x?e.jsx(K,{size:18,color:"inherit",sx:{mr:-3}}):null,n.InputProps.endAdornment]})}}}),renderOption:(n,t,P)=>{const{key:R,...O}=n,W=ee(t.name,P.inputValue,{insideWords:!0}),E=se(t.name,W);return e.jsx("li",{...O,children:e.jsx(k,{component:y,href:s(t.id),color:"inherit",underline:"none",children:E.map((S,F)=>e.jsx(u,{component:"span",sx:{typography:"body2",fontWeight:"fontWeightMedium",...S.highlight&&{color:"primary.main",fontWeight:"fontWeightSemiBold"}},children:S.text},F))})},R)}})}function pe(s){const[o,r]=d.useState([]),[a,h]=d.useState(!1),i=d.useCallback(async()=>{h(!0);try{await new Promise(c=>setTimeout(c,500));const l=L.filter(({name:c,endpoint:p})=>[c,p].some(x=>x?.toLowerCase().includes(s.toLowerCase())));r(l)}catch(l){console.error(l)}finally{h(!1)}},[s]);return d.useEffect(()=>{s?i():r([])},[i,s]),{searchResults:o,searchLoading:a}}function ue(){const[s,o]=d.useState("latest"),[r,a]=d.useState(L),h=he({inputData:r,sortBy:s}),i=d.useCallback(p=>{o(p)},[]),l=d.useCallback(p=>{a(x=>x.filter(f=>f.id!==p)),V.success("Integration deleted successfully!")},[]),c=()=>e.jsxs(u,{sx:{gap:3,display:"flex",justifyContent:"space-between",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"flex-end",sm:"center"}},children:[e.jsx(de,{redirectPath:p=>j.dashboard.integration.details(p)}),e.jsx(u,{sx:{gap:1,flexShrink:0,display:"flex"},children:e.jsx(ce,{sort:s,onSort:i,sortOptions:J})})]});return e.jsxs(_,{children:[e.jsx(D,{heading:"Integrations",links:[{name:"Dashboard",href:j.dashboard.overview.analytics},{name:"Integration",href:j.dashboard.integration.root},{name:"List"}],sx:{mb:{xs:3,md:5}}}),e.jsx(ae,{spacing:2.5,sx:{mb:{xs:3,md:5}},children:c()}),e.jsx(le,{integrations:h,onDelete:l})]})}function he({inputData:s,sortBy:o}){return o==="latest"&&(s=g(s,["createdAt"],["desc"])),o==="oldest"&&(s=g(s,["createdAt"],["asc"])),o==="name-asc"&&(s=g(s,["name"],["asc"])),o==="name-desc"&&(s=g(s,["name"],["desc"])),o==="status"&&(s=g(s,["status"],["asc"])),s}function De(){return e.jsx(ue,{})}export{De as default};
