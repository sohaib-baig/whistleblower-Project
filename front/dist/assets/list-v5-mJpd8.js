import{a0 as A,bI as P,a4 as D,j as e,a7 as $,I as h,B as f,bO as M,L as T,y as C,a6 as N,T as H,bJ as E,bK as O,M as R,c as I,r as p,p as b,u as V,cG as G,b4 as L,cH as _,b as q,bv as F,W as z,aa as J,d0 as K,x as Q}from"./index-BJkBHIXD.js";import{C as U}from"./confirm-dialog-D488U7AY.js";import{C as X}from"./Card-CU8jzKuK.js";import{P as Y,p as Z}from"./Pagination-BT9THikJ.js";import{m as ee,p as se}from"./index-BdvNLWsN.js";import{S as oe}from"./search-not-found-BYtFGFNz.js";import{A as te}from"./Autocomplete-vOabT0lM.js";import{T as re}from"./TextField-BfOXJaKd.js";import{I as ne}from"./InputAdornment-Cyf39fZQ.js";import{S as ie}from"./Stack-DSqJGNfN.js";import{o as k}from"./orderBy-BP_idRMj.js";import"./role-create-edit-form-Dqn7imsy.js";import"./html-to-markdown-DFGv9hum.js";import"./styles-CIBYb4dP.js";import"./LastPage-CrCg5Ljk.js";import"./Select-CM-FquqI.js";import"./Chip-Cd7PxQUv.js";import"./index.esm-DG78EUPk.js";import"./zod-DbnPk1Kl.js";import"./schemas-BaSQ7w8v.js";import"./fields-wQ2IQIfM.js";import"./text-transform-DM798QSo.js";import"./index-BdCJuPE0.js";import"./rhf-phone-input-DvY4aKGv.js";import"./index-CDpvdXdB.js";import"./rhf-text-field-D45rQogC.js";import"./RadioGroup-eX8WPtuC.js";import"./FormControlLabel-Do9AncA_.js";import"./rhf-select-BCHEEYe2.js";import"./styles-B-zEs6qR.js";import"./format-number-BErDzwe7.js";import"./upload-default-BMHhCMpu.js";import"./tslib.es6-CTYbIaVE.js";import"./DatePicker-D3hVcc_W.js";import"./schema-utils-C_-d4BNQ.js";import"./form-provider-BYLnCB41.js";import"./TableHead-D9jAElFw.js";import"./TableContainer-D0zNvGRU.js";import"./CardHeader-BmHD0Q2N.js";async function ae(s){try{return await new Promise(o=>setTimeout(o,500)),A.success("Role deleted successfully!"),{success:!0}}catch(o){throw console.error("Error deleting role:",o),A.error("Failed to delete role"),o}}function le({roleItem:s,editHref:o,detailsHref:l,onDelete:t,sx:x,...a}){const i=P(),c=D(),d=s.permissions?.length||0,u=s.permissions?.reduce((n,j)=>n+j.permissions.filter(g=>g.checked).length,0)||0,y=s.permissions?.map(n=>n.name).join(", ")||"No modules",S=s.permissions?.reduce((n,j)=>(j.permissions.forEach(g=>{g.checked&&(n[g.name]=(n[g.name]||0)+1)}),n),{})||{},r=Object.entries(S).map(([n,j])=>`${n}: ${j}`).join(", ")||"No permissions",m=()=>e.jsx(E,{open:i.open,anchorEl:i.anchorEl,onClose:i.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(O,{children:[e.jsx("li",{children:e.jsxs(R,{component:C,href:o,onClick:()=>i.onClose(),children:[e.jsx(h,{icon:"solar:pen-bold"}),"Edit"]})}),e.jsxs(R,{onClick:()=>{c.onTrue(),i.onClose()},sx:{color:"error.main"},children:[e.jsx(h,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),w=()=>e.jsx(U,{open:c.value,onClose:c.onFalse,title:"Delete Role",content:"Are you sure you want to delete this role? This action cannot be undone.",action:e.jsx(I,{variant:"contained",color:"error",onClick:t,children:"Delete"})});return e.jsxs(e.Fragment,{children:[e.jsxs(X,{sx:x,...a,children:[e.jsx($,{onClick:i.onOpen,sx:{position:"absolute",top:8,right:8},children:e.jsx(h,{icon:"eva:more-vertical-fill"})}),e.jsxs(f,{sx:{p:3,pb:2},children:[e.jsx(M,{sx:{mb:1},primary:e.jsx(T,{component:C,href:o,color:"inherit",children:s.title}),slotProps:{primary:{sx:{typography:"subtitle1"}},secondary:{sx:{mt:1,typography:"caption",color:"text.disabled"}}}}),e.jsxs(f,{sx:{gap:.5,display:"flex",alignItems:"center",color:"primary.main",typography:"caption"},children:[e.jsx(h,{width:16,icon:"solar:shield-check-bold"}),u," permissions"]})]}),e.jsx(N,{sx:{borderStyle:"dashed"}}),e.jsx(f,{sx:{p:3,rowGap:1.5,display:"grid",gridTemplateColumns:"repeat(2, 1fr)"},children:[{label:`${d} Modules`,icon:e.jsx(h,{width:16,icon:"solar:list-bold",sx:{flexShrink:0}})},{label:y,icon:e.jsx(h,{width:16,icon:"solar:add-folder-bold",sx:{flexShrink:0}})},{label:`${u} Permissions`,icon:e.jsx(h,{width:16,icon:"solar:check-circle-bold",sx:{flexShrink:0}})},{label:r,icon:e.jsx(h,{width:16,icon:"solar:shield-check-bold",sx:{flexShrink:0}})}].map(n=>e.jsxs(f,{sx:{gap:.5,minWidth:0,flexShrink:0,display:"flex",alignItems:"center",color:"text.disabled"},children:[n.icon,e.jsx(H,{variant:"caption",noWrap:!0,children:n.label})]},n.label))})]}),m(),w()]})}function ce({roles:s,onDeleteRole:o}){const l=p.useCallback(t=>{o(t)},[o]);return e.jsxs(e.Fragment,{children:[e.jsx(f,{sx:{gap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"}},children:s.map(t=>e.jsx(le,{roleItem:t,editHref:b.dashboard.role.edit(t.id),detailsHref:b.dashboard.role.details(t.id),onDelete:()=>l(t.id)},t.id))}),s.length>8&&e.jsx(Y,{count:8,sx:{mt:{xs:8,md:8},[`& .${Z.ul}`]:{justifyContent:"center"}}})]})}function de({sort:s,onSort:o,sortOptions:l}){const t=P(),x=()=>e.jsx(E,{open:t.open,anchorEl:t.anchorEl,onClose:t.onClose,children:e.jsx(O,{children:l.map(a=>e.jsx(R,{selected:a.value===s,onClick:()=>{t.onClose(),o(a.value)},children:a.label},a.value))})});return e.jsxs(e.Fragment,{children:[e.jsxs(I,{disableRipple:!0,color:"inherit",onClick:t.onOpen,endIcon:e.jsx(h,{icon:t.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill"}),sx:{fontWeight:"fontWeightSemiBold"},children:["Sort by:",e.jsx(f,{component:"span",sx:{ml:.5,fontWeight:"fontWeightBold",textTransform:"capitalize"},children:s})]}),x()]})}function pe({redirectPath:s,sx:o}){const l=V(),[t,x]=p.useState(""),[a,i]=p.useState(null),c=G(t),{searchResults:d,searchLoading:u}=me(c),y=p.useCallback(r=>{i(r),r&&l.push(s(r.id))},[s,l]),S={width:320,[`& .${L.listbox}`]:{[`& .${L.option}`]:{p:0,[`& .${_.root}`]:{px:1,py:.75,width:1}}}};return e.jsx(te,{autoHighlight:!0,popupIcon:null,loading:u,options:d,value:a,onChange:(r,m)=>y(m),onInputChange:(r,m)=>x(m),getOptionLabel:r=>r.title,noOptionsText:e.jsx(oe,{query:c}),isOptionEqualToValue:(r,m)=>r.id===m.id,slotProps:{paper:{sx:S}},sx:[{width:{xs:1,sm:260}},...Array.isArray(o)?o:[o]],renderInput:r=>e.jsx(re,{...r,placeholder:"Search...",slotProps:{input:{...r.InputProps,startAdornment:e.jsx(ne,{position:"start",children:e.jsx(h,{icon:"eva:search-fill",sx:{ml:1,color:"text.disabled"}})}),endAdornment:e.jsxs(e.Fragment,{children:[u?e.jsx(q,{size:18,color:"inherit",sx:{mr:-3}}):null,r.InputProps.endAdornment]})}}}),renderOption:(r,m,w)=>{const{key:n,...j}=r,g=ee(m.title,w.inputValue,{insideWords:!0}),W=se(m.title,g);return e.jsx("li",{...j,children:e.jsx(T,{component:C,href:s(m.id),color:"inherit",underline:"none",children:W.map((v,B)=>e.jsx(f,{component:"span",sx:{typography:"body2",fontWeight:"fontWeightMedium",...v.highlight&&{color:"primary.main",fontWeight:"fontWeightSemiBold"}},children:v.text},B))})},n)}})}function me(s){const[o,l]=p.useState([]),[t,x]=p.useState(!1),a=p.useCallback(async()=>{x(!0);try{await new Promise(c=>setTimeout(c,500));const i=F.filter(({title:c})=>[c].some(d=>d?.toLowerCase().includes(s.toLowerCase())));l(i)}catch(i){console.error(i)}finally{x(!1)}},[s]);return p.useEffect(()=>{s?a():l([])},[a,s]),{searchResults:o,searchLoading:t}}function he(){const[s,o]=p.useState("latest"),[l,t]=p.useState(F),x=xe({inputData:l,sortBy:s}),a=p.useCallback(d=>{o(d)},[]),i=p.useCallback(async d=>{try{await ae(d),t(u=>u.filter(y=>y.id!==d))}catch(u){console.error("Error deleting role:",u)}},[]),c=()=>e.jsxs(f,{sx:{gap:3,display:"flex",justifyContent:"space-between",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"flex-end",sm:"center"}},children:[e.jsx(pe,{redirectPath:d=>b.dashboard.role.details(d)}),e.jsx(f,{sx:{gap:1,flexShrink:0,display:"flex"},children:e.jsx(de,{sort:s,onSort:a,sortOptions:K})})]});return e.jsxs(z,{children:[e.jsx(J,{heading:"List",links:[{name:"Dashboard",href:b.dashboard.overview.analytics},{name:"Role",href:b.dashboard.role.root},{name:"List"}],action:e.jsx(I,{component:C,href:b.dashboard.role.new,variant:"contained",startIcon:e.jsx(h,{icon:"mingcute:add-line"}),children:"Add role"}),sx:{mb:{xs:3,md:5}}}),e.jsx(ie,{spacing:2.5,sx:{mb:{xs:3,md:5}},children:c()}),e.jsx(ce,{roles:x,onDeleteRole:i})]})}function xe({inputData:s,sortBy:o}){return o==="latest"&&(s=k(s,["createdAt"],["desc"])),o==="oldest"&&(s=k(s,["createdAt"],["asc"])),o==="popular"&&(s=k(s,["totalViews"],["desc"])),s}const ue={title:`Role list | Dashboard - ${Q.appName}`};function ss(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:ue.title}),e.jsx(he,{})]})}export{ss as default};
